define(["react","@grafana/ui","tslib","@grafana/data","@grafana/runtime","lodash"],(function(e,t,a,n,r,l){return function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a(a.s=55)}([function(t,a){t.exports=e},function(e,a){e.exports=t},function(e,t){e.exports=a},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t){e.exports=l},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,a){var n=a(12),r=a(31),l=a(32),i=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?r(e):l(e)}},function(e,t,a){var n=a(13),r="object"==typeof self&&self&&self.Object===Object&&self,l=n||r||Function("return this")();e.exports=l},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t){e.exports=function(e){return e}},function(e,t,a){var n=a(7),r=a(6);e.exports=function(e){if(!r(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,a){var n=a(8).Symbol;e.exports=n},function(e,t,a){(function(t){var a="object"==typeof t&&t&&t.Object===Object&&t;e.exports=a}).call(this,a(30))},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,a){var n=a(11),r=a(16);e.exports=function(e){return null!=e&&r(e.length)&&!n(e)}},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t){var a=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&a.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,a){var n=a(21),r=a(14),l=a(38),i=a(39),o=Object.prototype,u=o.hasOwnProperty,s=n((function(e,t){e=Object(e);var a=-1,n=t.length,s=n>2?t[2]:void 0;for(s&&l(t[0],t[1],s)&&(n=1);++a<n;)for(var c=t[a],p=i(c),d=-1,m=p.length;++d<m;){var v=p[d],f=e[v];(void 0===f||r(f,o[v])&&!u.call(e,v))&&(e[v]=c[v])}return e}));e.exports=s},function(e,t,a){"use strict";function n(){var e=Object.create(null),t=0,a=0,n=0,r=!1;function l(t){n--,delete e[t]}this.put=function(t,a,r,i){if(void 0!==r&&("number"!=typeof r||isNaN(r)||r<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==i&&"function"!=typeof i)throw new Error("Cache timeout callback must be a function");var o=e[t];o?clearTimeout(o.timeout):n++;var u={value:a,expire:r+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){l(t),i&&i(t,a)}.bind(this),r)),e[t]=u,a},this.del=function(t){var a=!0,n=e[t];return n?(clearTimeout(n.timeout),!isNaN(n.expire)&&n.expire<Date.now()&&(a=!1)):a=!1,a&&l(t),a},this.clear=function(){for(var l in e)clearTimeout(e[l].timeout);n=0,e=Object.create(null),r&&(t=0,a=0)},this.get=function(l){var i=e[l];if(void 0!==i){if(isNaN(i.expire)||i.expire>=Date.now())return r&&t++,i.value;r&&a++,n--,delete e[l]}else r&&a++;return null},this.size=function(){return n},this.memsize=function(){var t,a=0;for(t in e)a++;return a},this.debug=function(e){r=e},this.hits=function(){return t},this.misses=function(){return a},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var a in e){var n=e[a];t[a]={value:n.value,expire:n.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,a){var n=JSON.parse(t),r=Date.now(),l=a&&a.skipDuplicates;for(var i in n)if(n.hasOwnProperty(i)){if(l)if(e[i])continue;var o=n[i],u=o.expire-r;if(u<=0){this.del(i);continue}u=u>0?u:void 0,this.put(i,o.value,u)}return this.size()}}e.exports=new n,e.exports.Cache=n},function(e,t,a){var n=a(10),r=a(22),l=a(24);e.exports=function(e,t){return l(r(e,t,n),e+"")}},function(e,t,a){var n=a(23),r=Math.max;e.exports=function(e,t,a){return t=r(void 0===t?e.length-1:t,0),function(){for(var l=arguments,i=-1,o=r(l.length-t,0),u=Array(o);++i<o;)u[i]=l[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=l[i];return s[t]=a(u),n(e,this,s)}}},function(e,t){e.exports=function(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}},function(e,t,a){var n=a(25),r=a(37)(n);e.exports=r},function(e,t,a){var n=a(26),r=a(27),l=a(10),i=r?function(e,t){return r(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:l;e.exports=i},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t,a){var n=a(28),r=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=r},function(e,t,a){var n=a(29),r=a(36);e.exports=function(e,t){var a=r(e,t);return n(a)?a:void 0}},function(e,t,a){var n=a(11),r=a(33),l=a(6),i=a(35),o=/^\[object .+?Constructor\]$/,u=Function.prototype,s=Object.prototype,c=u.toString,p=s.hasOwnProperty,d=RegExp("^"+c.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!l(e)||r(e))&&(n(e)?d:o).test(i(e))}},function(e,t){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch(e){"object"==typeof window&&(a=window)}e.exports=a},function(e,t,a){var n=a(12),r=Object.prototype,l=r.hasOwnProperty,i=r.toString,o=n?n.toStringTag:void 0;e.exports=function(e){var t=l.call(e,o),a=e[o];try{e[o]=void 0;var n=!0}catch(e){}var r=i.call(e);return n&&(t?e[o]=a:delete e[o]),r}},function(e,t){var a=Object.prototype.toString;e.exports=function(e){return a.call(e)}},function(e,t,a){var n,r=a(34),l=(n=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!l&&l in e}},function(e,t,a){var n=a(8)["__core-js_shared__"];e.exports=n},function(e,t){var a=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return a.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t){var a=Date.now;e.exports=function(e){var t=0,n=0;return function(){var r=a(),l=16-(r-n);if(n=r,l>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,a){var n=a(14),r=a(15),l=a(17),i=a(6);e.exports=function(e,t,a){if(!i(a))return!1;var o=typeof t;return!!("number"==o?r(a)&&l(t,a.length):"string"==o&&t in a)&&n(a[t],e)}},function(e,t,a){var n=a(40),r=a(51),l=a(15);e.exports=function(e){return l(e)?n(e,!0):r(e)}},function(e,t,a){var n=a(41),r=a(42),l=a(44),i=a(45),o=a(17),u=a(47),s=Object.prototype.hasOwnProperty;e.exports=function(e,t){var a=l(e),c=!a&&r(e),p=!a&&!c&&i(e),d=!a&&!c&&!p&&u(e),m=a||c||p||d,v=m?n(e.length,String):[],f=v.length;for(var h in e)!t&&!s.call(e,h)||m&&("length"==h||p&&("offset"==h||"parent"==h)||d&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||o(h,f))||v.push(h);return v}},function(e,t){e.exports=function(e,t){for(var a=-1,n=Array(e);++a<e;)n[a]=t(a);return n}},function(e,t,a){var n=a(43),r=a(9),l=Object.prototype,i=l.hasOwnProperty,o=l.propertyIsEnumerable,u=n(function(){return arguments}())?n:function(e){return r(e)&&i.call(e,"callee")&&!o.call(e,"callee")};e.exports=u},function(e,t,a){var n=a(7),r=a(9);e.exports=function(e){return r(e)&&"[object Arguments]"==n(e)}},function(e,t){var a=Array.isArray;e.exports=a},function(e,t,a){(function(e){var n=a(8),r=a(46),l=t&&!t.nodeType&&t,i=l&&"object"==typeof e&&e&&!e.nodeType&&e,o=i&&i.exports===l?n.Buffer:void 0,u=(o?o.isBuffer:void 0)||r;e.exports=u}).call(this,a(18)(e))},function(e,t){e.exports=function(){return!1}},function(e,t,a){var n=a(48),r=a(49),l=a(50),i=l&&l.isTypedArray,o=i?r(i):n;e.exports=o},function(e,t,a){var n=a(7),r=a(16),l=a(9),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,e.exports=function(e){return l(e)&&r(e.length)&&!!i[n(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,a){(function(e){var n=a(13),r=t&&!t.nodeType&&t,l=r&&"object"==typeof e&&e&&!e.nodeType&&e,i=l&&l.exports===r&&n.process,o=function(){try{var e=l&&l.require&&l.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=o}).call(this,a(18)(e))},function(e,t,a){var n=a(6),r=a(52),l=a(53),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return l(e);var t=r(e),a=[];for(var o in e)("constructor"!=o||!t&&i.call(e,o))&&a.push(o);return a}},function(e,t){var a=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||a)}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var a in Object(e))t.push(a);return t}},,function(e,t,a){"use strict";a.r(t);var n=a(3),r=a(2),l=a(19),i=a.n(l),o=a(4),u=a(5),s=a.n(u),c={selectedQueryCategory:{label:"Metrics",value:"Metrics",description:"Get Timeseries metrics."},basic_sysparam:[{1:null,2:null,3:null,4:null}],getAlertCount:{label:"No",value:"false"},cacheOverride:"",compressLogs:!1,grafanaTimerange:!1,sortDirection:"ASC"},p=a(20),d=a.n(p),m=["sys_created_on","created_on","last_event_time","sys_updated_on","time","start_time","end_time","Updated"];function v(e,t){var a=Object(o.getTemplateSrv)().replace(e,t,"csv"),n=a.indexOf(",");if(n>=0){for(;n>=0;)n=(a=a.replace(",","|")).indexOf(",");a="("+a+")"}return a.startsWith("(")&&a.endsWith(")")?"/"+a+"/":a}function f(e,t){return Object(o.getTemplateSrv)().replace(e,t,"csv")}function h(e,t,a,r,l){var i,o={name:n.TIME_SERIES_TIME_FIELD_NAME,type:n.FieldType.time,config:{custom:{}},values:new n.ArrayVector(e.map((function(e){return e[1]})))};i=(n.FieldType.string,new n.ArrayVector(e.map((function(e){return e[0]}))));var u=[o,{name:n.TIME_SERIES_VALUE_FIELD_NAME,type:null!=l?l:n.FieldType.number,labels:{},config:{displayName:t,custom:{}},values:i}];return{name:t,refId:a.refId,fields:u,length:e.length}}function y(e){1}function g(e){return")"===e.charAt(e.length-2)&&"("===e.charAt(1)&&(e=e.charAt(0)+e.slice(2,-2)+e.charAt(e.length-1)),e}function b(e){var t="";if(1===e.length)return e[0];if("string"==typeof e)return e;for(var a=0;a<e.length;a++)t+="|"+e[a];return"|"===t.charAt(0)&&(t="/"+(t=t.substring(1,t.length))+"/"),t}var O,_=a(5),C=(O=_)&&O.__esModule?O:{default:O};var E=function(){function e(e,t,a,n){this.requestOptions={headers:e,withCredentials:t,url:a},this.cacheTimeout=n,this.cache=new d.a.Cache}return e.prototype.cachedGet=function(e,t,a,n,l,i,u){return Object(r.__awaiter)(this,void 0,void 0,(function(){var l,u,s,c,p,d,m=this;return Object(r.__generator)(this,(function(v){return l=60,l=void 0!==n&&n?n:this.cacheTimeout,u=this.requestOptions.url+t,s=u+="/body/"+i,a&&Object.keys(a).length>0&&(u=u+(u.search(/\?/)>=0?"&":"?")+a.map((function(e){var t=Object(r.__read)(e,2),a=t[0],n=t[1];return encodeURIComponent(a)+"="+encodeURIComponent(n)})).join("&")),this.lastCacheDuration!==l&&this.cache.del(u),this.lastCacheDuration=l,!(c=this.cache.get(u))&&u.includes("?")&&this.cache.keys().map((function(e){if(e.includes(s)&&e.includes("?")){var t=e.substring(e.indexOf("?")+1,e.length),a=(t=t.split("&"))[0].substring(t[0].indexOf("=")+1,t[0].length),n=t[1].substring(t[1].indexOf("=")+1,t[1].length),r=u.substring(u.indexOf("?")+1,u.length),i=(r=r.split("&"))[0].substring(r[0].indexOf("=")+1,r[0].length),o=r[1].substring(r[1].indexOf("=")+1,r[1].length);i-a<=1e3*l&&o-n<=1e3*l&&(c=m.cache.get(e))}})),c?[2,Promise.resolve(c)]:(p="?"+a.map((function(e){var t=Object(r.__read)(e,2),a=t[0],n=t[1];return encodeURIComponent(a)+"="+encodeURIComponent(n)})).join("&"),d="","GET"===e?d=Object(o.getBackendSrv)().get(this.requestOptions.url+t,p):"POST"===e&&(d=Object(o.getBackendSrv)().post(this.requestOptions.url+t+p,i)),this.cache.put(u,d,1e3*l),[2,d])}))}))},e.prototype.request=function(e){e.withCredentials=this.requestOptions.withCredentials,e.headers=this.requestOptions.headers;var t=e.url;e.url=this.requestOptions.url+t;var a=t.indexOf("?");-1===a&&(a=t.length);var n=t.substring(0,a),r=[];-1!==e.url.indexOf("?")&&e.url.substring(e.url.indexOf("?")+1,e.url.length).split("&").map((function(e){var t=[e.substring(0,e.indexOf("=")),e.substring(e.indexOf("=")+1,e.length)];r.push(t)}));if(e.cacheOverride){var l=e.cacheOverride.indexOf("s"),i=e.cacheOverride.indexOf("m");-1!==l?e.cacheOverride=parseInt(e.cacheOverride.substring(0,l),10):-1!==i&&(e.cacheOverride=60*parseInt(e.cacheOverride.substring(0,i),10))}return this.cachedGet(e.method,n,r,e.cacheOverride,e.headers,e.data,e)},e.prototype.mapAlertTags=function(e){var t=[];return e.map((function(e){if(void 0!==e.additional_info){var a=JSON.parse(e.additional_info);Object.keys(a).filter((function(e){return e.includes("tbac-")})).map((function(e){t.push({key:e,value:a[e]})}))}})),t=t.filter((function(e,t,a){return t===a.findIndex((function(t){return t.value===e.value&&t.key===e.key}))}))},e.prototype.mapChecksToValue=function(e){return C.default.map(e,(function(e,t){if(void 0!==e.name&&void 0!==e.id)return""!==e.name&&null!==e.name||(e.name="NULL"),""!==e.id&&null!==e.id||(e.id="NULL"),{text:e.name,value:e.id};var a=Object.keys(e);return""!==e[a[0]]&&null!==e[a[0]]||(e[a[0]]="NULL"),!a[1]||""!==e[a[1]]&&null!==e[a[1]]||(e[a[1]]="NULL"),{label:e[a[0]],value:a[1]?e[a[1]]:e[a[0]]}}))},e.prototype.mapChecksToValuePlusSuffix=function(e){return C.default.map(e,(function(e,t){var a=Object.keys(e);return{label:e[a[0]],value:a[1]?e[a[1]]:e[a[0]],suffix:e[a[2]]}}))},e.prototype.mapValueSuffixToColumns=function(e){var t=C.default.map(e,(function(e,t){return{label:e.label+":display",value:e.value+":d"}})),a=C.default.map(e,(function(e,t){return{label:e.label+":value",value:e.value+":v"}})),n=t.concat(a);return n=s.a.orderBy(n,["label"],["asc"])},e.prototype.mapValueAsSuffix=function(e){var t=C.default.map(e,(function(e){var t={label:e.label,value:e.value,description:e.value};return void 0!==e.options&&(t.options=C.default.map(e.options,(function(e){return{label:e.label,value:e.value,description:e.value}})),t.options=s.a.orderBy(t.options,["label"],["asc"])),t}));return t=s.a.orderBy(t,["label"],["asc"])},e.prototype.mapSuffixToLabel=function(e){return C.default.map(e,(function(e){return{label:e.label+" ("+e.suffix+")",value:e.value}}))},e.prototype.appendInstanceNameToResponse=function(e,t){return e=C.default.map(e,(function(e,a){return e.instanceName=t,e}))},e.prototype.mapToTextValue=function(e){return C.default.map(e,(function(e,t){return e&&e.text&&e.value?{text:e.text,value:e.value}:C.default.isObject(e)?{text:e,value:t}:{text:e,value:e}}))},e.prototype.mapOutageResponseToFrame=function(e,t){return e.map((function(e){var a=e.ci;return h(e.datapoints,a,t,0,n.FieldType.string)}))},e.prototype.mapTrendResponseToFrame=function(e,t){return Object.keys(e[0]).map((function(a){return h(e[0][a].datapoints,a,t,0,n.FieldType.number)}))},e.prototype.mapMetricsResponseToFrame=function(e,t){return e.map((function(e){var a=e.source+":"+e.metricName;return e.type.length>0&&(a+=":"+e.type),h(e.datapoints,a,t,0,n.FieldType.number)}))},e.prototype.mapAnamMetricsResponseToFrame=function(e,t){var a=e.map((function(a){var r=a.ciName,l=a.metricName;return a.data.map((function(a){var i=r+":"+l+":"+a.type;return 1!==e.length||"UPPER"!==a.type&&"LOWER"!==a.type||(i=a.type),function(e,t,a,r,l){var i,o={name:n.TIME_SERIES_TIME_FIELD_NAME,type:n.FieldType.time,config:{custom:{}},values:new n.ArrayVector(e.map((function(e){return e.x})))};i=(n.FieldType.string,new n.ArrayVector(e.map((function(e){return e.y}))));var u=[o,{name:n.TIME_SERIES_VALUE_FIELD_NAME,type:null!=l?l:n.FieldType.number,labels:{},config:{displayName:t,custom:{}},values:i}];return{name:t,refId:a.refId,fields:u,length:e.length}}(a.data,i,t,0,n.FieldType.number)}))}));return a=[].concat.apply([],a)},e.prototype.mapTextResponseToFrame=function(e){var t=new n.MutableDataFrame({fields:[]});if(y(),!(e.length>0))return[];e=e.map((function(e){if(e.additional_info){var t=JSON.parse(e.additional_info),a=Object.keys(t).filter((function(e){return e.includes("tbac-")}));e.tbac_data={};for(var n=0;n<a.length;n++)e.tbac_data[a[n]]=t[a[n]];return e.tbac_data=JSON.stringify(e.tbac_data),e}return e}));for(var a,r,l=Object.keys(e[0]),i=0;i<l.length;i++){var o=e.map((function(e){return e[l[i]]}));"new"!==l[i]&&"value:display"!==l[i]||(o=this.sanitizeValues(o));var u=n.FieldType.string;o.length>=0&&(a=o[0],r=l[i],u=m.includes(r)?n.FieldType.time:"number"==typeof a?n.FieldType.number:n.FieldType.string),t.addField({name:l[i],type:u,values:o})}return y(),t},e.prototype.sanitizeValues=function(e){var t=[];return e.map((function(e){for(;-1!==e.indexOf("[code]");){var a=e.substring(0,e.indexOf("[code]")),n=e.substring(e.indexOf("[/code]")+7,e.length);if(-1!==e.indexOf("<a")){var r=e.substring(e.indexOf("<a"),e.indexOf("</a>",e.indexOf("<a"))),l=r.substring(r.indexOf(">")+1,r.length);-1!==l.indexOf("<")&&(l=l.substring(0,l.indexOf("<"))),e=a+l+n}else e=a+n}t.push(e)})),t},e}();function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var T=function(){function e(e){var t=e.basicAuth,a=e.withCredentials,n=e.url,r=e.apiPath,l=e.cacheTimeout;this.apiPath=r;var i={"Content-Type":"application/json"};"string"==typeof t&&t.length>0&&(i.Authorization=t),this.apiClient=new E(i,a,n,l)}return e.prototype.getTopologyFrame=function(e,t,a){return this.getTopology(e,t,a).then((function(t){var a=[{columns:[{text:"type"},{type:"time",text:"Time"},{text:"app"},{text:"target_app"},{text:"req_rate"},{text:"error_rate"}],rows:t,refId:e.refId||void 0,meta:void 0}];return y(),{data:a}}))},e.prototype.getTopology=function(e,t,a){var n=v(e.service,t.scopedVars);void 0!==e.selectedServiceList&&(n=f(e.selectedServiceList.value,t.scopedVars));var r="";void 0!==e.topology_child_depth&&(r=v(e.topology_child_depth,t.scopedVars));var l="";void 0!==e.topology_parent_depth&&(l=v(e.topology_parent_depth,t.scopedVars));var i="";void 0!==e.topology_filter&&e.topology_filter&&(i=f(e.topology_filter,t.scopedVars));var o="";void 0!==e.topology_namespaces&&e.topology_namespaces&&(o=f(e.topology_namespaces,t.scopedVars));var u="";void 0!==e.sysparam_query&&""!==e.sysparam_query&&(u=f(e.sysparam_query,t.scopedVars)),u=this.removeFiltersWithAll(u);var s="";void 0!==e.selectedTopologyDependsOnFilter&&(s=v(e.selectedTopologyDependsOnFilter.value,t.scopedVars));var c='{"targets":[{"target":"'+n+'","child_depth":"'+r+'","parent_depth":"'+l+'","exclude_classes":"'+i+'","sysparm_query":"'+u+'","namespaces":"'+o+'","dependsOn":"'+s+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/topology",data:c,method:"POST",cacheOverride:""===a?null:a}).then((function(e){return y(),y(),y(),y(),y(),e.rows})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.getMetrics=function(e,t,a,n,r){var l=this;var i=!1,o="",u=[],s="",c=[],p="",d="";if(void 0!==e.selectedSourceList){var m=[];e.selectedSourceList.map((function(e){m.push(v(e.value,n.scopedVars))})),o=b(m)}void 0!==e.selectedMetricTypeList&&(e.selectedMetricTypeList.map((function(e){u.push(v(e.value,n.scopedVars))})),s=b(u)),void 0!==e.selectedMetricNameList&&(e.selectedMetricNameList.length>0?(e.selectedMetricNameList.map((function(e){c.push(v(e.value,n.scopedVars))})),p=b(c)):p=v(e.selectedMetricNameList.value,n.scopedVars)),void 0!==e.selectedMetricAnomalyList&&"true"===v(e.selectedMetricAnomalyList.value,n.scopedVars)&&(i=!0),void 0!==e.sysparam_query&&(d=f(e.sysparam_query,n.scopedVars)),d=this.removeFiltersWithAll(d),p=g(p);var h='{"targets":[{"target":"'+(o=g(o))+'","resourceName":"'+s+'","metricName":"'+p+'","sysparm_query":"'+d+'"}]}',y=this.apiPath+"/v1/query/single_metric?startTime="+t+"&endTime="+a;return"*"===p&&(y=this.apiPath+"/v1/query/all_metrics?startTime="+t+"&endTime="+a),!0===i&&(y=this.apiPath+"/v1/query/anomaly_metrics?startTime="+t+"&endTime="+a),this.apiClient.request({url:y,data:h,method:"POST",cacheOverride:""===r?null:r}).then((function(t){return!0===i?l.apiClient.mapAnamMetricsResponseToFrame(t,e):l.apiClient.mapMetricsResponseToFrame(t,e)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.getAlerts=function(e,t,a,n,r,l){var i=this;var o="";void 0!==e.selectedServiceList&&(o=f(e.selectedServiceList.value,n.scopedVars));var u="";void 0!==e.selectedSourceList&&(u=f(e.selectedSourceList.value,n.scopedVars));var s=o,c="Active",p="service",d="";void 0!==e.selectedAlertStateList&&(c=e.selectedAlertStateList.value),e.selectedAlertTypeList&&("CI"===e.selectedAlertTypeList.value?(p="ci",s=u):"OS"===e.selectedAlertTypeList.value?(p="os",-1!==(s=u).indexOf("(")&&(s=s.substring(s.indexOf("(")+1,s.indexOf(")")))):"None"===e.selectedAlertTypeList.value&&(p="none")),void 0!==e.sysparam_query&&e.sysparam_query&&(d=f(e.sysparam_query,n.scopedVars)),d=this.removeFiltersWithAll(d);var m="";if(void 0!==e.tagKeys&&void 0!==e.tagValues)for(var v=function(t){if("$"===e.tagKeys[t].value.charAt(0)){var a=f(e.tagKeys[t].value,n.scopedVars);a.split(",").map((function(t){for(var a=0;a<e.tagValues.length;a++)if("$"===e.tagValues[a].value.charAt(0)){(r=f(e.tagValues[a].value,n.scopedVars)).split(",").map((function(e){""!==t&&""!==e&&(m+=t+"="+e+",")}))}else{var r=e.tagValues[a].value;""!==t&&""!==r&&(m+=t+"="+r+",")}}))}else for(var r=e.tagKeys[t].value,l=0;l<e.tagValues.length;l++)if("$"===e.tagValues[l].value.charAt(0)){(i=f(e.tagValues[l].value,n.scopedVars)).split(",").map((function(e){""!==r&&""!==e&&(m+=r+"="+e+",")}))}else{var i=e.tagValues[l].value;""!==r&&""!==i&&(m+=r+"="+i+",")}},h=0;h<e.tagKeys.length;h++)v(h);","===m.charAt(m.length-1)&&(m=m.substring(0,m.length-1));var g=9999;void 0!==e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(g=e.rowLimit);var b=0;"number"==typeof e.page&&e.page>=0&&(b=e.page);var O='{"targets":[{"target":"'+s+'","sysparm_query":"'+d+'","alertType":"'+p+'","alertState":"'+c+'","limit":'+g+',"page":'+b+',"tagFilters":"'+m+'"}]}',_=this.apiPath+"/v1/query/alerts";return e.grafanaTimerange&&(_+="?startTime="+t+"&endTime="+a),this.apiClient.request({url:_,data:O,method:"POST",cacheOverride:""===l?null:l}).then((function(e){return y(),y(),e=i.apiClient.appendInstanceNameToResponse(e,r),y(),i.apiClient.mapTextResponseToFrame(e)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.getChanges=function(e,t,a,n,r){var l=this;var i="";void 0!==e.selectedServiceList&&null!==e.selectedServiceList&&e.selectedServiceList.length>0&&(i=f(e.selectedServiceList.value,n.scopedVars));var o="";void 0!==e.selectedSourceList&&null!==e.selectedSourceList&&e.selectedSourceList.length>0&&(o=f(e.selectedSourceList.value,n.scopedVars));var u=i,s="service";void 0!==e.selectedChangeTypeList&&("CI"===e.selectedChangeTypeList.value?(s="ci",u=o):"None"===e.selectedChangeTypeList.value&&(s="none",u=""));var c="";void 0!==e.sysparam_query&&e.sysparam_query&&(c=f(e.sysparam_query,n.scopedVars)),c=this.removeFiltersWithAll(c);var p=9999;void 0!==e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(p=e.rowLimit);var d=0;"number"==typeof e.page&&e.page>=0&&(d=e.page);var m='{"targets":[{"target":"'+u+'","sysparm_query":"'+c+'","alertType":"'+s+'","limit":'+p+',"page":'+d+"}]}";var v=this.apiPath+"/v1/query/changes";return!0===e.grafanaTimerange&&(v+="?startTime="+t+"&endTime="+a),this.apiClient.request({url:v,data:m,method:"POST",cacheOverride:""===r?null:r}).then((function(e){return y(),y(),l.apiClient.mapTextResponseToFrame(e)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.getLiveACCData=function(e,t,a,n,r){void 0!==e.live_osquery&&f(e.live_osquery,n.scopedVars);return this.apiClient.mapTextResponseToFrame({data:[{mem_in_megs:"740.39",name:"nscd",pid:"689"},{mem_in_megs:"333.76",name:"rsyslogd",pid:"29468"},{mem_in_megs:"125.67",name:"acc",pid:"30448"},{mem_in_megs:"109.54",name:"lvmetad",pid:"13729"},{mem_in_megs:"78.15",name:"xenstore-watch",pid:"707"}]})},e.prototype.queryTable=function(e,t,a,n,r){var l=this;var i="";void 0!==e.tableName&&""!==e.tableName.value&&(i=v(e.tableName.value,n.scopedVars));var o="";void 0!==e.selectedtableColumns&&e.selectedtableColumns.length>0&&(e.selectedtableColumns.map((function(e){o+=v(e.value,n.scopedVars)+","})),","===o.charAt(o.length-1)&&(o=o.substring(0,o.length-1)));var u="";if(-1!==e.basic_sysparam.constructor.toString().indexOf("Array"))for(var s=0;s<e.basic_sysparam.length;s++){var c=e.basic_sysparam[s],p="";c[1]&&(p=f(c[1].value,n.scopedVars));var d="";c[2]&&(d=c[2].value);var m="";c[3]&&(m=f(c[3].value,n.scopedVars));var h="";c[4]&&(h=c[4].value),u+=h+p+d+m}u=this.removeFiltersWithAll(u);var g=9999;void 0!==e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(g=e.rowLimit);var b=0;"number"==typeof e.page&&e.page>=0&&(b=e.page);var O="",_="";void 0!==e.sortBy&&null!==e.sortBy&&(O=f(e.sortBy.value,n.scopedVars),_=e.sortDirection);var C="false";void 0!==e.getAlertCount&&(C=e.getAlertCount.value);var E='{"targets":[{"target":"'+i+'","columns":"'+o+'","sysparm":"'+u+'","limit":'+g+',"page":'+b+',"sortBy":"'+O+'","sortDirection":"'+_+'","getAlertCount":'+C+"}]}";return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:E,method:"POST",cacheOverride:""===r?null:r}).then((function(e){return y(),y(),l.apiClient.mapTextResponseToFrame(e)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.getRowCount=function(e,t,a){var n=this,r="";void 0!==e.tableName&&""!==e.tableName.value&&(r=v(e.tableName.value,t.scopedVars));var l="";void 0!==e.sysparam_query&&""!==e.sysparam_query&&(l=f(e.sysparam_query,t.scopedVars));var i='{"targets":[{"target":"'+r+'","sysparm":"'+(l=this.removeFiltersWithAll(l))+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/row_count",data:i,method:"POST",cacheOverride:""===a?null:a}).then((function(e){return y(),y(),n.apiClient.mapTextResponseToFrame(e)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.getAggregateQuery=function(e,t,a){var n=this,r="",l="",i="",o="",u="";void 0!==e.tableName&&""!==e.tableName.value&&(r=v(e.tableName.value,t.scopedVars)),"string"==typeof e.groupBy?""!==e.groupBy&&(l=f(e.groupBy,t.scopedVars)):"object"===w(e.groupBy)&&null!==e.groupBy&&""!==e.groupBy.value&&(l=f(e.groupBy.value,t.scopedVars)),void 0!==e.selectedAggregateType&&""!==e.selectedAggregateType.value&&(i=e.selectedAggregateType.value),void 0!==e.aggregateColumn&&""!==e.aggregateColumn&&(o=e.aggregateColumn),void 0!==e.sysparam_query&&""!==e.sysparam_query&&(u=f(e.sysparam_query,t.scopedVars)),u=this.removeFiltersWithAll(u);var s=9999;void 0!==e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(s=e.rowLimit);var c='{"targets":[{"target":"'+r+'","type":"'+i+'","column":"'+o+'","groupBy":"'+l+'","sysparm":"'+u+'","limit":'+s+"}]}";return this.apiClient.request({url:this.apiPath+"/v1/query/aggregate",data:c,method:"POST",cacheOverride:""===a?null:a}).then((function(e){return y(),y(),n.apiClient.mapTextResponseToFrame(e)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.getGeohashMap=function(e,t,a){var n=this,r="",l="",i="";void 0!==e.tableName&&""!==e.tableName.value&&(r=v(e.tableName.value,t.scopedVars)),"string"==typeof e.groupBy?""!==e.groupBy&&(l=f(e.groupBy,t.scopedVars)):"object"===w(e.groupBy)&&null!==e.groupBy&&""!==e.groupBy.value&&(l=f(e.groupBy.value,t.scopedVars)),void 0!==e.sysparam_query&&""!==e.sysparam_query&&(i=f(e.sysparam_query,t.scopedVars));var o='{"targets":[{"target":"'+r+'","column":"'+l+'","sysparm":"'+(i=this.removeFiltersWithAll(i))+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/geohash_map",data:o,method:"POST",cacheOverride:""===a?null:a}).then((function(e){return y(),y(),n.apiClient.mapTextResponseToFrame(e)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.queryLogData=function(e,t,a,n,r){var l=this,i=e.compressLogs,o="";if(-1!==e.basic_sysparam.constructor.toString().indexOf("Array"))for(var u=0;u<e.basic_sysparam.length;u++){var s=e.basic_sysparam[u],c="";s[1]&&(c=f(s[1].value,n.scopedVars));var p="";s[2]&&(p=s[2].value);var d="";s[3]&&(d=f(s[3].value,n.scopedVars));var m="";s[4]&&(m=s[4].value),o+=m+c+p+d}o=this.removeFiltersWithAll(o);var v=9999;void 0!==e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(v=e.rowLimit);var h=0;"number"==typeof e.page&&e.page>=0&&(h=e.page);var g="",b="";void 0!==e.sortBy&&null!==e.sortBy&&(g=f(e.sortBy.value,n.scopedVars),b=e.sortDirection);var O="";void 0!==e.elasticSearch&&(O=f(e.elasticSearch,n.scopedVars));var _='{"targets":[{"sysparm":"'+o+'","limit":'+v+',"page":'+h+',"sortBy":"'+g+'","sortDirection":"'+b+'","esSearch":"'+O+'","startTime":'+t+',"endTime":'+a+',"compressLog":'+i+"}]}";return this.apiClient.request({url:this.apiPath+"/v1/query/logs",data:_,method:"POST",cacheOverride:""===r?null:r}).then((function(e){return y(),y(),l.apiClient.mapTextResponseToFrame(e)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.getTrendData=function(e,t,a,n,r){var l=this;var i="",o="",u="",s="",c="",p="",d=1;if(void 0!==e.tableName&&""!==e.tableName.value&&(i=v(e.tableName.value,n.scopedVars)),-1!==e.basic_sysparam.constructor.toString().indexOf("Array"))for(var m=0;m<e.basic_sysparam.length;m++){var h=e.basic_sysparam[m],g="";h[1]&&(g=f(h[1].value,n.scopedVars));var b="";h[2]&&(b=h[2].value);var O="";h[3]&&(O=f(h[3].value,n.scopedVars));var _="";h[4]&&(_=h[4].value),o+=_+g+b+O}o=this.removeFiltersWithAll(o),void 0!==e.elasticSearch&&(u=f(e.elasticSearch,n.scopedVars)),"string"==typeof e.groupBy?""!==e.groupBy&&(s=f(e.groupBy,n.scopedVars)):"object"===w(e.groupBy)&&null!==e.groupBy&&""!==e.groupBy.value&&(s=f(e.groupBy.value,n.scopedVars)),void 0!==e.selectedTrendColumn&&null!==e.selectedTrendColumn&&(c=f(e.selectedTrendColumn.value,n.scopedVars)),void 0!==e.selectedTrendBy&&null!==e.selectedTrendBy&&(p=f(e.selectedTrendBy.value,n.scopedVars)),void 0!==e.trendPeriod&&e.trendPeriod>0&&(d=e.trendPeriod);var C='{"targets":[{"target":"'+i+'","sysparm":"'+o+'","esSearch":"'+u+'","trendColumn":"'+c+'","trendBy":"'+p+'","period":'+d+',"groupBy":"'+s+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/trend?startTime="+t+"&endTime="+a,data:C,method:"POST",cacheOverride:""===r?null:r}).then((function(t){return y(),y(),l.apiClient.mapTrendResponseToFrame(t,e)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.getOutageStatus=function(e,t,a,n,r){var l=this,i="";void 0!==e.selectedServiceList&&null!==e.selectedServiceList.value&&(i=f(e.selectedServiceList.value,n.scopedVars));var o=!1;"boolean"==typeof e.showPercent&&(o=e.showPercent);var u="";void 0!==e.sysparam_query&&(u=f(e.sysparam_query,n.scopedVars)),u=this.removeFiltersWithAll(u);var s=9999;void 0!==e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(s=e.rowLimit);var c=0;"number"==typeof e.page&&e.page>=0&&(c=e.page);var p='{"targets":[{"target":"'+i+'","showPercent":'+o+',"sysparm":"'+u+'","limit":'+s+',"page":'+c+"}]}";return this.apiClient.request({url:this.apiPath+"/v1/query/outage",data:p,method:"POST",cacheOverride:""===r?null:r}).then((function(t){return y(),y(),o?l.apiClient.mapTextResponseToFrame(t):l.apiClient.mapOutageResponseToFrame(t,e)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.getAnomaly=function(e,t,a,n,r){var l=this;var i="";void 0!==e.selectedtableColumns&&e.selectedtableColumns.length>0&&(e.selectedtableColumns.map((function(e){i+=v(e.value,n.scopedVars)+","})),","===i.charAt(i.length-1)&&(i=i.substring(0,i.length-1)));var o="";if(-1!==e.basic_sysparam.constructor.toString().indexOf("Array"))for(var u=0;u<e.basic_sysparam.length;u++){var s=e.basic_sysparam[u],c="";s[1]&&(c=f(s[1].value,n.scopedVars));var p="";s[2]&&(p=s[2].value);var d="";s[3]&&(d=f(s[3].value,n.scopedVars));var m="";s[4]&&(m=s[4].value),o+=m+c+p+d}o=this.removeFiltersWithAll(o);var h=9999;void 0!==e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(h=e.rowLimit);var g=0;"number"==typeof e.page&&e.page>=0&&(g=e.page);var b="",O="";void 0!==e.sortBy&&null!==e.sortBy&&(b=f(e.sortBy.value,n.scopedVars),O=e.sortDirection);var _='{"targets":[{"columns":"'+i+'","sysparm":"'+o+'","limit":'+h+',"page":'+g+',"sortBy":"'+b+'","sortDirection":"'+O+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/anomaly",data:_,method:"POST",cacheOverride:""===r?null:r}).then((function(e){return y(),y(),l.apiClient.mapTextResponseToFrame(e)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.getGenericVariable=function(e,t,a,n,r){var l=this,i='{"targets":[{"tableName":"'+e+'","nameColumn":"'+t+'","idColumn":"'+a+'","sysparm":"'+n+'","limit":'+r+"}]}";return this.apiClient.request({url:this.apiPath+"/v1/variable/generic",data:i,method:"POST"}).then((function(e){return y(),l.apiClient.mapChecksToValue(e)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.getMetricNamesInCIs=function(e,t){var a=this;var n=b(t),r='{"targets":[{"target":"'+(n=g(n))+'","metricType":"'+e+'"}]}',l=this.apiPath+"/v1/variable/metrics";return this.apiClient.request({url:l,data:r,method:"POST"}).then((function(e){return y(),a.apiClient.mapChecksToValue(e)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.getNestedCIS=function(e){var t=this,a='{"targets":[{"ci": "'+e.ci+'",\n      "parentDepth":"'+e.parentDepth+'",\n      "childDepth":"'+e.childDepth+'",\n      "sysparm":"'+e.sysparam+'",\n      "type":"ci"}]}';return this.apiClient.request({url:this.apiPath+"/v1/variable/nested_value",data:a,method:"POST"}).then((function(e){return y(),t.apiClient.mapChecksToValue(e)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.getNestedClasses=function(e){var t=this,a='{"targets":[{"ci": "'+e.ci+'",\n      "parentDepth":"'+e.parentDepth+'",\n      "childDepth":"'+e.childDepth+'",\n      "sysparm":"'+e.sysparam+'",\n      "type":"class"}]}';return this.apiClient.request({url:this.apiPath+"/v1/variable/nested_value",data:a,method:"POST"}).then((function(e){return y(),t.apiClient.mapChecksToValue(e)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.getMetricAnomalyOptions=function(){return[{label:"true",value:"true"},{label:"false",value:"false"}]},e.prototype.getAlertTypeOptions=function(){return[{label:"CI",value:"CI",description:"Get Alerts at the CI level"},{label:"Service",value:"Service",description:"Get Alerts at the Service level"},{label:"OS",value:"OS",description:"Get Alerts for all Agents in the class"},{label:"None",value:"None",description:"Ignore CI selection and use sysparam_query"}]},e.prototype.getAlertStateOptions=function(){return[{label:"Active",value:"Active",description:"Get Open and Reopen Alerts"},{label:"All",value:"All",description:"Get All alerts Open,Reopen, and Closed"}]},e.prototype.getChangeTypeOptions=function(){return[{label:"CI",value:"CI",description:"Get Changes at the CI level"},{label:"Service",value:"Service",description:"Get Changes at the Service level"},{label:"None",value:"None",description:"Ignore CI selection and use sysparam_query"}]},e.prototype.getAggregateTypeOptions=function(){return[{label:"AVG",value:"AVG"},{label:"COUNT",value:"COUNT"},{label:"MIN",value:"MIN"},{label:"MAX",value:"MAX"},{label:"STDDEV",value:"STDDEV"},{label:"SUM",value:"SUM"}]},e.prototype.getSysparamTypeOptions=function(){return[{label:"is",value:"=",description:"="},{label:"is not",value:"!=",description:"!="},{label:"starts with",value:"STARTSWITH",description:"STARTSWITH"},{label:"ends with",value:"ENDSWITH",description:"ENDSWITH"},{label:"contains",value:"LIKE",description:"LIKE"},{label:"does not contain",value:"NOT LIKE",description:"NOT LIKE"},{label:"is empty",value:"ISEMPTY",description:"ISEMPTY"},{label:"is not empty",value:"ISNOTEMPTY",description:"ISNOTEMPTY"},{label:"is anything",value:"ANYTHING",description:"ANYTHING"},{label:"is one of",value:"IN",description:"IN"},{label:"is not one of",value:"NOT IN",description:"NOT IN"},{label:"is empty string",value:"EMPTYSTRING",description:"EMPTYSTRING"},{label:"less than or is",value:"<=",description:"<="},{label:"greater than or is",value:">=",description:">="},{label:"between",value:"BETWEEN",description:"BETWEEN"},{label:"is same as",value:"SAMEAS",description:"SAMEAS"},{label:"is different",value:"NSAMEAS",description:"NSAMEAS"}]},e.prototype.getTrendByOptions=function(){return[{label:"Minute",value:"minute"},{label:"Hour",value:"hour"}]},e.prototype.loadServiceOptions=function(e){var t=this,a="";void 0!==e&&(a=e);var n='{"targets":[{"target":"cmdb_ci_service","columns":"name:d,sys_id:v","sysparm":"operational_status=1^name!=All^nameLIKE'+a+'","limit":100,"sortBy":"name","sortDirection":"ASC"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:n,method:"POST"}).then((function(e){return y(),y(),y(t.apiClient.mapChecksToValue(e)),t.apiClient.mapChecksToValue(e)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.loadCIOptions=function(e,t){var a=this,n="";void 0!==t&&(n=t);var r="";return r=void 0!==e?'{"targets":[{"target":"em_impact_graph","columns":"child_name:d,child_id:v,child_id:d","sysparm":"business_service='+e+"^child_nameLIKE"+n+'","limit":100,"sortBy":"ci_name","sortDirection":"ASC"}]}':'{"targets":[{"target":"cmdb_ci","columns":"name:d,sys_id:v,sys_class_name:d","sysparm":"nameLIKE'+n+'^name!=NULL","limit":100,"sortBy":"cmdb_ci.name","sortDirection":"ASC"}]}',this.apiClient.request({url:this.apiPath+"/v1/query/table",data:r,method:"POST"}).then((function(e){y(),y();var t=a.apiClient.mapChecksToValuePlusSuffix(e);return y(),a.apiClient.mapSuffixToLabel(t)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.loadResourceOptions=function(e,t){var a=this,n="",r="";(void 0!==t&&(r=t),void 0!==e)&&(n='{"targets":[{"target":"sa_metric_map","columns":"resource_id:d,resource_id:v","sysparm":"cmdb_ciIN'+e.map((function(e){return e.value}))+"^resource_idLIKE"+r+'^resource_id!=NULL","limit":100,"sortBy":"resource_id","sortDirection":"ASC"}]}');return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:n,method:"POST"}).then((function(e){y(),y();var t=[{label:"*",value:"*"}].concat(a.apiClient.mapChecksToValue(e));return t=t.filter((function(e,t,a){return t===a.findIndex((function(t){return t.value===e.value}))}))})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.loadMetricOptions=function(e,t){var a=this,n="",r="";(void 0!==t&&(r=t),void 0!==e)&&(n='{"targets":[{"target":"sa_metric_map","columns":"metric_type_id.metric_type_tiny_name:d,metric_type_id:v","sysparm":"cmdb_ciIN'+e.map((function(e){return e.value}))+"^metric_type_id.metric_type_tiny_nameLIKE"+r+'","limit":100,"sortBy":"","sortDirection":"ASC"}]}');return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:n,method:"POST"}).then((function(e){y(),y();var t=[{label:"*",value:"*"}].concat(a.apiClient.mapChecksToValue(e));return t=t.filter((function(e,t,a){return t===a.findIndex((function(t){return t.value===e.value}))}))})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.loadColumnChoices=function(e,t,a){var n=this,r='{"targets":[{"target":"sys_choice","columns":"label,value","sysparm":"name='+e+"^element!=NULL^elementLIKE"+t+"^labelLIKE"+a+'^language=en","limit":100}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:r,method:"POST"}).then((function(e){return y(),y(),n.apiClient.mapChecksToValue(e)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.getTableColumnOptions=function(e){var t=this;if(void 0!==e){var a='{"targets":[{"table":"'+e+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/select/table_columns",data:a,method:"POST"}).then((function(e){return y(),y(),t.apiClient.mapValueAsSuffix(e)})).catch((function(e){throw new Error(e.statusText)}))}},e.prototype.loadTableColumns=function(e,t,a){var n=this,r="";if("string"==typeof a&&(r=a.trim()),void 0===e)return[];var l='{"targets":[{"table":"'+e+'","search":"'+r+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/select/table_columns",data:l,method:"POST"}).then((function(e){return y(),y(),n.apiClient.mapValueAsSuffix(e)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.loadTableOptions=function(e){var t=this,a='{"targets":[{"target":"sys_db_object","columns":"label,name","sysparm":"nameLIKE'+e+"^ORlabelLIKE"+e+'","limit":100}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:a,method:"POST"}).then((function(e){y(),y();var a=t.apiClient.mapChecksToValue(e);return y(),t.apiClient.mapValueAsSuffix(a)})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.getTopologyCISummary=function(e){var t='{"targets":[{"target":"'+e+'"}]}';return this.apiClient.request({url:this.apiPath+"/query/ci_summary",data:t,method:"POST"}).then((function(e){return y(),y(),e.data}))},e.prototype.getAlertTags=function(e,t,a){var n=this;"Active"===e&&(t+="state!=Closed");var r='{"targets":[{"target":"em_alert","columns":"additional_info","sysparm":"'+t+'","limit":'+a+',"sortBy":"","sortDirection":"ASC"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:r,method:"POST"}).then((function(e){y(),y();var t=n.apiClient.mapAlertTags(e);return y(),t})).catch((function(e){throw new Error(e.statusText)}))},e.prototype.removeFiltersWithAll=function(e){for(var t=e.indexOf("*");-1!==t;){var a=e.substring(t+1),n=e.substring(0,t+1),r=n.lastIndexOf("^");-1===r&&(r=0),t=(e=(n=n.substring(0,r))+a).indexOf("*")}return e},e}(),S=function(e){function t(t){var a=e.call(this,t)||this,n={type:t.type,url:t.url,name:t.name,basicAuth:t.basicAuth,withCredentials:t.withCredentials,apiPath:t.jsonData.apiPath,cacheTimeout:t.jsonData.cacheTimeout};return a.globalImage=t.jsonData.imageURL,a.instanceName=t.jsonData.instanceName,a.apiPath=n.apiPath,a.snowConnection=new T(n),a.annotations={},a}return Object(r.__extends)(t,e),t.prototype.metricFindQuery=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,n,l,i,u,s,c,p,d,m,v,f,h,y,g,b,O,_;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return"global_image"===e.namespace?[2,[{label:this.globalImage,value:this.globalImage}]]:"global_instance_name"===e.namespace?[2,[{label:this.instanceName,value:this.instanceName}]]:"generic"===e.namespace?void 0!==e.rawQuery?(a=e.rawQuery.split("||"),n=void 0===a[0]?"":Object(o.getTemplateSrv)().replace(a[0],t.scopedVars,"csv"),l=void 0===a[1]?"":Object(o.getTemplateSrv)().replace(a[1],t.scopedVars,"csv"),i=void 0===a[2]?"":Object(o.getTemplateSrv)().replace(a[2],t.scopedVars,"csv"),g=void 0===a[3]?"":Object(o.getTemplateSrv)().replace(a[3],t.scopedVars,"csv"),b=void 0===a[4]?"9999":Object(o.getTemplateSrv)().replace(a[4],t.scopedVars,"csv"),[2,this.snowConnection.getGenericVariable(n,l,i,g,b)]):[2,[]]:"metric_names"===e.namespace?(u=Object(o.getTemplateSrv)().replace(e.rawQuery,t.scopedVars,"csv"),s=u.split(","),[2,this.snowConnection.getMetricNamesInCIs("",s)]):"golden_metric_names"===e.namespace?(u=Object(o.getTemplateSrv)().replace(e.rawQuery,t.scopedVars,"csv"),s=u.split(","),[2,this.snowConnection.getMetricNamesInCIs("GOLDEN",s)]):"custom_kpis"===e.namespace?(u=Object(o.getTemplateSrv)().replace(e.rawQuery,t.scopedVars,"csv"),s=u.split(","),[2,this.snowConnection.getMetricNamesInCIs("CUSTOM_KPIS",s)]):"nested_cis"===e.namespace?((c=e.rawQuery.split("||")).map((function(e,a){c[a]=Object(o.getTemplateSrv)().replace(e,t.scopedVars,"csv"),0===c[a].indexOf("$")&&(c=c.splice(a))})),p={ci:void 0===c[0]?"":c[0],parentDepth:void 0===c[1]?"":c[1],childDepth:void 0===c[2]?"":c[2],sysparam:void 0===c[3]?"":c[3]},[2,this.snowConnection.getNestedCIS(p)]):"nested_classes"===e.namespace?((d=e.rawQuery.split("||")).map((function(e,a){d[a]=Object(o.getTemplateSrv)().replace(e,t.scopedVars,"csv"),0===d[a].indexOf("$")&&(d=d.splice(a))})),m={ci:void 0===d[0]?"":d[0],parentDepth:void 0===d[1]?"":d[1],childDepth:void 0===d[2]?"":d[2],sysparam:void 0===d[3]?"":d[3]},[2,this.snowConnection.getNestedClasses(m)]):"tagKeys"!==e.namespace?[3,3]:void 0===e.rawQuery?[3,2]:((v=e.rawQuery.split("||")).map((function(e,a){v[a]=Object(o.getTemplateSrv)().replace(e,t.scopedVars,"csv"),0===v[a].indexOf("$")&&(v=v.splice(a))})),y=void 0===v[0]?"All":v[0],g=void 0===v[1]?"":v[1],b=void 0===v[2]?"9999":v[2],[4,this.snowConnection.getAlertTags(y,g,b)]);case 1:return O=r.sent(),(_=O.map((function(e){return{text:e.key,value:e.key}}))).unshift({text:"None",value:""}),[2,_];case 2:return[2,[]];case 3:return"tagValues"!==e.namespace?[3,6]:void 0===e.rawQuery?[3,5]:((f=e.rawQuery.split("||")).map((function(e,a){f[a]=Object(o.getTemplateSrv)().replace(e,t.scopedVars,"csv"),0===f[a].indexOf("$")&&(f=f.splice(a))})),h=void 0===f[0]?"":f[0],y=void 0===f[1]?"All":f[1],g=void 0===f[2]?"":f[2],b=void 0===f[3]?"9999":f[3],[4,this.snowConnection.getAlertTags(y,g,b)]);case 4:return O=(O=r.sent()).filter((function(e){if(h.includes(e.key))return e})),(_=O.map((function(e){return{text:e.value,value:e.value}}))).unshift({text:"None",value:""}),[2,_];case 5:return[2,[]];case 6:return[2]}}))}))},t.prototype.query=function(e){return Object(r.__awaiter)(this,void 0,Promise,(function(){var t,a,l,o,u,p,d=this;return Object(r.__generator)(this,(function(r){return t=e.range,a=t.from.valueOf(),l=t.to.valueOf(),o=e.targets[0].selectedQueryCategory.value,u=e.targets[0].cacheOverride,"Topology"===o?[2,this.snowConnection.getTopologyFrame(e.targets[0],e,u)]:(p=s.a.map(e.targets,(function(t){if(t.hide)return[];var n=s.a.cloneDeep(t),r=i()(n,c),o=r.selectedQueryCategory.value,u=r.cacheOverride;switch(o){case"Metrics":return d.snowConnection.getMetrics(n,a,l,e,u);case"Alerts":return d.snowConnection.getAlerts(n,a,l,e,d.instanceName,u);case"Changes":return d.snowConnection.getChanges(n,a,l,e,u);case"Live_Agent_Data":return d.snowConnection.getLiveACCData(n,a,l,e,u);case"Table":return d.snowConnection.queryTable(n,a,l,e,u);case"Row_Count":return d.snowConnection.getRowCount(n,e,u);case"Aggregate":return d.snowConnection.getAggregateQuery(n,e,u);case"Geohash_Map":return d.snowConnection.getGeohashMap(n,e,u);case"Log_Data":return d.snowConnection.queryLogData(n,a,l,e,u);case"Trend_Data":return d.snowConnection.getTrendData(n,a,l,e,u);case"Outage_Status":return d.snowConnection.getOutageStatus(n,a,l,e,u);case"Anomaly":return d.snowConnection.getAnomaly(n,a,l,e,u);default:return[]}})),[2,Promise.all(s.a.flatten(p)).then(s.a.flatten).then((function(t){return{data:t,state:n.LoadingState.Done,key:e.requestId}}))])}))}))},t.prototype.testDatasource=function(){return this.snowConnection.apiClient.request({url:this.apiPath,method:"GET"}).then((function(){return{status:"success",message:"Data source connection is successful",title:"Success"}})).catch((function(e){return{status:"error",message:"Data source connection failed: "+e.statusText,title:"Error"}}))},t}(n.DataSourceApi),V=a(0),x=a.n(V),A=a(1),I=function(e){var t=e.loadOptions,a=e.value,n=e.updateQuery;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Service",labelWidth:20},x.a.createElement(A.AsyncSelect,{width:20,loadOptions:t,defaultOptions:!0,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return n("selectedServiceList",{label:e,value:e})},onChange:function(e){return n("selectedServiceList",e)},menuPlacement:"bottom"}))))},F=function(e){var t=e.loadOptions,a=e.value,n=e.updateQuery;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"CI",labelWidth:20},x.a.createElement(A.AsyncSelect,{width:20,loadOptions:t,value:a,defaultValue:a,isMulti:!0,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){var t=[];void 0!==a?(t=Object(r.__spreadArray)([],Object(r.__read)(a),!1))[t.length]={label:e,value:e}:t=[{label:e,value:e}],n("selectedSourceList",t)},onChange:function(e){return n("selectedSourceList",e)},menuPlacement:"bottom"}))))},j=function(e){var t=e.loadOptions,a=e.value,n=e.updateQuery;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Resource ID",labelWidth:20},x.a.createElement(A.AsyncSelect,{width:20,loadOptions:t,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){var t=[];void 0!==a?(t=Object(r.__spreadArray)([],Object(r.__read)(a),!1))[t.length]={label:e,value:e}:t=[{label:e,value:e}],n("selectedMetricTypeList",t)},onChange:function(e){return n("selectedMetricTypeList",e)}}))))},L=function(e){var t=e.loadOptions,a=e.value,n=e.updateQuery;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Metric Name",labelWidth:20},x.a.createElement(A.AsyncSelect,{width:20,loadOptions:t,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){var t=[];void 0!==a?(t=Object(r.__spreadArray)([],Object(r.__read)(a),!1))[t.length]={label:e,value:e}:t=[{label:e,value:e}],n("selectedMetricNameList",t)},onChange:function(e){return n("selectedMetricNameList",e)},className:"coloredSelect"}))))},N=function(e){var t=e.options,a=e.value,n=e.updateQuery;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Anomaly",labelWidth:20},x.a.createElement(A.Select,{width:20,options:t,value:a,defaultValue:a,isClearable:!0,onChange:function(e){return n("selectedMetricAnomalyList",e)}}))))},q=function(e){var t=e.updateQuery,a=e.defaultValue;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Sysparam Query",labelWidth:20},x.a.createElement(A.Input,{name:"sysparam_query",width:20,defaultValue:a,onBlur:function(e){return t("sysparam_query",e.target.value)}}))))},P=function(e){var t=e.options,a=e.value,n=e.updateQuery;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Alert Type Filter",labelWidth:20},x.a.createElement(A.Select,{width:20,options:t,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,onChange:function(e){return n("selectedAlertTypeList",e)}}))))},Q=function(e){var t=e.options,a=e.value,n=e.updateQuery;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Alert State Filter",labelWidth:20},x.a.createElement(A.Select,{width:20,options:t,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,onChange:function(e){return n("selectedAlertStateList",e)}}))))},R=function(e){var t=e.options,a=e.value,n=e.updateQuery;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Change Type Filter",labelWidth:20},x.a.createElement(A.Select,{width:20,options:t,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,onChange:function(e){return n("selectedChangeTypeList",e)}}))))},D=function(e){var t=e.loadOptions,a=e.value,n=e.updateQuery;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Starting Point",labelWidth:20},x.a.createElement(A.AsyncSelect,{width:20,loadOptions:t,defaultOptions:!0,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return n("selectedServiceList",{label:e,value:e})},onChange:function(e){return n("selectedServiceList",e)},menuPlacement:"bottom"}))))},M=function(e){var t=e.updateQuery,a=e.defaultValue;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Parent Depth",labelWidth:20},x.a.createElement(A.Input,{name:"parent_depth",width:20,defaultValue:a,onBlur:function(e){return t("topology_parent_depth",e.target.value)}}))))},B=function(e){var t=e.updateQuery,a=e.defaultValue;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Child Depth",labelWidth:20},x.a.createElement(A.Input,{name:"child_depth",width:20,defaultValue:a,onBlur:function(e){return t("topology_child_depth",e.target.value)}}))))},k=function(e){var t=e.updateQuery,a=e.defaultValue;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Osquery",labelWidth:20},x.a.createElement(A.Input,{name:"osquery",width:20,defaultValue:a,onBlur:function(e){return t("live_osquery",e.target.value)}}))))},W=function(e){var t=e.loadTableOptions,a=e.value,n=e.updateQuery;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Table Name",labelWidth:20},x.a.createElement(A.AsyncSelect,{prefix:x.a.createElement(A.Icon,{name:"table"}),loadOptions:t,className:"min-width-10 max-width-30",value:a,defaultValue:a,defaultOptions:!0,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return n("tableName",e)},onCreateOption:function(e){return n("tableName",{label:e,value:e})},menuPlacement:"bottom",maxMenuHeight:200}))))},G=function(e){var t=e.query,a=e.updateQuery,n=e.datasource,l=Object(r.__read)(Object(V.useState)(t.selectedtableColumns),2),i=l[0],o=l[1],u=Object(r.__read)(Object(V.useState)([{label:"Loading ...",value:""}]),2),s=u[0],c=u[1];return Object(V.useEffect)((function(){var e=[],a=!1;return function(){var l;Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,n.snowConnection.getTableColumnOptions(null===(l=t.tableName)||void 0===l?void 0:l.value)];case 1:return e=r.sent(),a||e.length>0&&(i.length>0&&(e=e.concat(i)),c(e)),[2]}}))}))}(),function(){a=!0}}),[n.snowConnection,t.tableName,i]),x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Table Columns",labelWidth:20,tooltip:"Leave columns blank to return all columns in the dictionary"},x.a.createElement(A.Select,{prefix:x.a.createElement(A.Icon,{name:"columns"}),className:"min-width-10 max-width-30",options:s,value:i,defaultValue:i,isSearchable:!0,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){a("selectedtableColumns",e),o(e)},onCreateOption:function(e){var t=[];void 0!==i?(t=Object(r.__spreadArray)([],Object(r.__read)(i),!1))[t.length]={label:e,value:e}:t=[{label:e,value:e}],a("selectedtableColumns",t),o(t)},menuPlacement:"bottom",maxMenuHeight:200}))))},K=function(e){var t=e.query,a=e.updateQuery,n=e.datasource,l=Object(r.__read)(Object(V.useState)(t.groupBy),2),i=l[0],o=l[1],u=Object(r.__read)(Object(V.useState)([{label:"Loading ...",value:""}]),2),s=u[0],c=u[1];return Object(V.useEffect)((function(){var e=[],a=!1;return function(){var l;Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,n.snowConnection.getTableColumnOptions(null===(l=t.tableName)||void 0===l?void 0:l.value)];case 1:return e=r.sent(),a||e.length>0&&c(e),[2]}}))}))}(),function(){a=!0}}),[n.snowConnection,t.tableName]),x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Group By",labelWidth:20,tooltip:"Select a column which will be used to group the results by."},x.a.createElement(A.Select,{width:20,options:s,value:i,defaultValue:i,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){a("groupBy",e),o(e)},onCreateOption:function(e){a("groupBy",{label:e,value:e}),o({label:e,value:e})},menuPlacement:"top",maxMenuHeight:200}))))},U=function(e){var t=e.options,a=e.value,n=e.updateQuery,r=e.defaultColumnValue;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Aggregate Function",labelWidth:20,tooltip:"Choose your aggregation function then the column to run this function on"},x.a.createElement(A.Select,{width:20,options:t,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return n("selectedAggregateType",{label:e,value:e})},onChange:function(e){return n("selectedAggregateType",e)}})),x.a.createElement(A.InlineField,null,x.a.createElement(A.Input,{name:"aggregate_column",width:20,defaultValue:r,onBlur:function(e){return n("aggregateColumn",e.target.value)}}))))},H=function(e){var t=e.query,a=e.updateQuery,n=e.datasource,l=e.sysparamTypeOptions,i=e.loadChoices,o=Object(r.__read)(Object(V.useState)([{label:"Loading ...",value:""}]),2),u=o[0],s=o[1];Object(V.useEffect)((function(){var e=[],a=!1;return function(){var l;Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,n.snowConnection.getTableColumnOptions(null===(l=t.tableName)||void 0===l?void 0:l.value)];case 1:return e=r.sent(),a||e.length>0&&s(e),[2]}}))}))}(),function(){a=!0}}),[n.snowConnection,t.tableName]);for(var c=Object(r.__spreadArray)([],Object(r.__read)(t.basic_sysparam),!1),p=function(e,t,n){var r=c;r[e][t]=n,a("basic_sysparam",r)},d=[{label:"AND",value:"^"},{label:"OR",value:"^OR"}],m=[],v=-1!==c.constructor.toString().indexOf("Array")?t.basic_sysparam.length:0,f=function(e){m.push(x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,0!==e&&x.a.createElement(A.InlineField,null,x.a.createElement(A.RadioButtonGroup,{options:d,value:void 0!==c[e][4]?c[e][4].value:null,onChange:function(t){return p(e,4,{label:t,value:t})}})),x.a.createElement(A.InlineField,{label:0===e?"Sysparam Query":void 0,labelWidth:0===e?20:void 0},x.a.createElement(A.Select,{className:"min-width-10",options:u,value:void 0!==c[e][1]?c[e][1]:null,defaultValue:void 0!==c[e][1]?c[e][1]:null,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(t){return p(e,1,t)},onCreateOption:function(t){return p(e,1,{label:t,value:t})},maxMenuHeight:200})),x.a.createElement(A.InlineField,null,x.a.createElement(A.Select,{width:20,options:l,value:void 0!==c[e][2]?c[e][2]:null,defaultValue:void 0!==c[e][2]?c[e][2]:null,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(t){return p(e,2,t)},onCreateOption:function(t){return p(e,2,{label:t,value:t})},maxMenuHeight:200})),x.a.createElement(A.InlineField,null,x.a.createElement(A.AsyncSelect,{className:"min-width-10",loadOptions:function(t){return i(e,t)},value:void 0!==c[e][3]?c[e][3]:null,defaultValue:void 0!==c[e][3]?c[e][3]:null,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(t){return p(e,3,t)},onCreateOption:function(t){return p(e,3,{label:t,value:t})},maxMenuHeight:200})),e>0&&x.a.createElement(A.InlineField,null,x.a.createElement(A.ToolbarButton,{icon:"trash-alt",variant:"destructive",iconOnly:!0,onClick:function(){return t=e,(n=c).splice(t,1),void a("basic_sysparam",n);var t,n}}))),e===v-1&&x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,null,x.a.createElement(A.ToolbarButton,{icon:"plus",variant:"primary",onClick:function(){return(e=c).push({1:null,2:null,3:null,4:{label:"AND",value:"^"}}),void a("basic_sysparam",e);var e}})))))},h=0;h<v;h++)f(h);return x.a.createElement(x.a.Fragment,null,m)},$=function(e){var t=e.loadOptions,a=e.value,n=e.updateQuery,r=e.directionValue;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Sort By",labelWidth:20},x.a.createElement(A.AsyncSelect,{className:"min-width-10",loadOptions:function(e){return t(!1,e)},value:a,defaultValue:a,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return n("sortBy",e)},onCreateOption:function(e){return n("sortBy",{label:e,value:e})},maxMenuHeight:200,menuPlacement:"top"})),x.a.createElement(A.InlineField,null,x.a.createElement(A.RadioButtonGroup,{value:r,options:[{label:"ASC",value:"ASC",icon:"arrow-up"},{label:"DESC",value:"DESC",icon:"arrow-down"}],onChange:function(e){return n("sortDirection",e)}}))))},z=function(e){var t=e.updateQuery,a=e.defaultValue;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Limit",labelWidth:20,tooltip:"Limit the number of results. Expects a number between 1 - 9999"},x.a.createElement(A.Input,{name:"limit",type:"number",max:9999,min:1,width:20,defaultValue:a,onBlur:function(e){return t("rowLimit",e.target.value)}}))))},Y=function(e){var t=e.updateQuery,a=e.defaultValue;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Elastic Search Query",labelWidth:20},x.a.createElement(A.Input,{name:"elasticSearch",width:20,defaultValue:a,onBlur:function(e){return t("elasticSearch",e.target.value)}}))))},J=function(e){var t=e.updateQuery,a=e.trendByOptions,n=e.query,l=e.datasource,i=Object(r.__read)(Object(V.useState)([{label:"Loading ...",value:""}]),2),o=i[0],u=i[1];return Object(V.useEffect)((function(){var e=[],t=!1;return function(){var a;Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,l.snowConnection.getTableColumnOptions(null===(a=n.tableName)||void 0===a?void 0:a.value)];case 1:return e=r.sent(),t||e.length>0&&u(e),[2]}}))}))}(),function(){t=!0}}),[l.snowConnection,n.tableName]),x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Trend",labelWidth:20},x.a.createElement(A.Select,{className:"min-width-10 max-width-30",options:o,value:n.selectedTrendColumn,defaultValue:n.selectedTrendColumn,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return t("selectedTrendColumn",e)},onCreateOption:function(e){return t("selectedTrendColumn",{label:e,value:e})},maxMenuHeight:200})),x.a.createElement(A.InlineField,null,x.a.createElement(A.Select,{className:"min-width-10 max-width-30",options:a,value:n.selectedTrendBy,defaultValue:n.selectedTrendBy,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return t("selectedTrendBy",e)},onCreateOption:function(e){return t("selectedTrendBy",{label:e,value:e})}})),x.a.createElement(A.InlineField,null,x.a.createElement(A.Input,{name:"period",type:"number",max:300,min:1,width:20,defaultValue:n.trendPeriod,onBlur:function(e){return t("trendPeriod",e.target.value)}}))))},X=function(e){var t=e.value,a=e.updateQuery;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Show Uptime %",labelWidth:20},x.a.createElement(A.RadioButtonGroup,{options:[{label:"False",value:!1},{label:"True",value:!0}],value:t||!1,onChange:function(e){return a("showPercent",e)}}))))},Z=function(e){var t=e.defaultValue,a=e.updateQuery;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Page",labelWidth:20,tooltip:"Page number used for pagination. Starts at page 0"},x.a.createElement(A.Input,{name:"page",type:"number",max:9999,min:0,width:20,defaultValue:t,onBlur:function(e){return a("page",e.target.valueAsNumber)}}))))},ee=function(e){var t=e.value,a=e.updateQuery;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Query Alert Count",labelWidth:20,tooltip:"Extra query per row to get the number of alerts on a ci. Adds extra processing, use wisely!"},x.a.createElement(A.RadioButtonGroup,{value:t.value,options:[{label:"No",value:"false"},{label:"Yes",value:"true"}],onChange:function(e){return a("getAlertCount",{label:e,value:e})}}))))},te=function(e){var t=e.value,a=e.updateQuery;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,null,x.a.createElement(A.RefreshPicker,{value:t,text:"Cache Override",intervals:["5s","30s","60s","2m","5m","15m","30m"],onIntervalChanged:function(e){return a("cacheOverride",e)}}))))},ae=function(e){var t=e.value,a=e.updateQuery;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Compress Logs",labelWidth:20},x.a.createElement(A.InlineSwitch,{value:t,onChange:function(e){return a("compressLogs",e.target.checked)}}))))},ne=function(e){var t=e.value,a=e.updateQuery;return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,null,x.a.createElement(A.Checkbox,{value:t,label:"Use Grafana Time Range",description:"If selected, only results that fit in the time range will be returned",onChange:function(e){return a("grafanaTimerange",e.target.checked)}}))))},re=function(e){var t=e.query,a=e.updateQuery,n=e.datasource,l=e.replaceMultipleVariables,i=Object(r.__read)(Object(V.useState)([{label:"Loading...",value:""}]),2),o=i[0],s=i[1],c=Object(r.__read)(Object(V.useState)([{label:"Loading...",value:""}]),2),p=c[0],d=c[1];Object(V.useEffect)((function(){var e=[],i=[],o=[];!function(){Object(r.__awaiter)(this,void 0,void 0,(function(){var c,p,m,v,f,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c=t.selectedAlertStateList,p=t.sysparam_query,m=t.rowLimit,p=l(p),[4,n.snowConnection.getAlertTags(c,p,m)];case 1:for(o=r.sent(),v=function(a){e.push({label:o[a].key,value:o[a].key}),void 0!==t.tagKeys&&void 0!==t.tagKeys[0]&&"$"!==t.tagKeys[0].value.charAt(0)&&t.tagKeys.map((function(e){o[a].key===e.value&&i.push({label:o[a].value,value:o[a].value})}))},f=0;f<o.length;f++)v(f);return e=e.filter((function(e,t,a){return t===a.findIndex((function(t){return t.value===e.value}))})),i=i.filter((function(e,t,a){return t===a.findIndex((function(t){return t.value===e.value}))})),void 0!==t.tagValues&&void 0!==t.tagValues[0]&&"$"!==t.tagValues[0].value.charAt(0)&&(h=t.tagValues,t.tagValues.map((function(e,t){var a=!1;i.map((function(t){e.value===t.value&&(a=!0)})),a||h.splice(t,1)})),Object(u.isEqual)(h,t.tagValues)||a("tagValues",h)),s(e),d(i),[2]}}))}))}()}),[n.snowConnection,t,a,l]);var m=o;void 0!==t.tagKeys&&(m=Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(o),!1),[t.tagKeys],!1),m=[].concat.apply([],m));var v=p;return void 0!==t.tagValues&&(v=Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(p),!1),[t.tagValues],!1),v=[].concat.apply([],v)),x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Tag Keys",labelWidth:20,tooltip:"Filter by tags located in additional info"},x.a.createElement(A.Select,{className:"min-width-10 max-width-20",options:m,value:t.tagKeys,defaultValue:t.tagKeys,isSearchable:!0,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return a("tagKeys",e)},onCreateOption:function(e){var n={label:e,value:e},l=[];void 0!==t.tagKeys?(l=Object(r.__spreadArray)([],Object(r.__read)(t.tagKeys),!1)).push(n):l=[n],a("tagKeys",l)},maxMenuHeight:200})),x.a.createElement(A.InlineField,{label:"Tag Values",labelWidth:20},x.a.createElement(A.Select,{className:"min-width-10 max-width-20",options:v,value:t.tagValues,defaultValue:t.tagValues,isSearchable:!0,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return a("tagValues",e)},onCreateOption:function(e){var n={label:e,value:e},l=[];void 0!==t.tagValues?(l=Object(r.__spreadArray)([],Object(r.__read)(t.tagValues),!1)).push(n):l=[n],a("tagValues",l)},maxMenuHeight:200}))))},le=function(e){var t,a=e.query,n=e.onChange,l=e.datasource,i=Object(u.defaults)(a,c),s=l.snowConnection.getMetricAnomalyOptions(),p=l.snowConnection.getAlertTypeOptions(),d=l.snowConnection.getAlertStateOptions(),m=l.snowConnection.getChangeTypeOptions(),v=l.snowConnection.getAggregateTypeOptions(),f=l.snowConnection.getSysparamTypeOptions(),h=l.snowConnection.getTrendByOptions(),y=function(e){return new Promise((function(t){setTimeout((function(){t(l.snowConnection.loadServiceOptions(e))}),500)}))},g=function(e){return new Promise((function(t){setTimeout((function(){var a;t(l.snowConnection.loadCIOptions(null===(a=i.selectedServiceList)||void 0===a?void 0:a.value,e))}),500)}))},b=function(e,t){return new Promise((function(a){setTimeout((function(){var n;a(l.snowConnection.loadTableColumns(null===(n=i.tableName)||void 0===n?void 0:n.value,e,t))}),500)}))},O=function(e,t){return new Promise((function(a){setTimeout((function(){var n,r;a(l.snowConnection.loadColumnChoices(null===(n=i.tableName)||void 0===n?void 0:n.value,null===(r=i.basic_sysparam[e][1])||void 0===r?void 0:r.value,t))}),500)}))},_=function(e){return new Promise((function(t){setTimeout((function(){t(l.snowConnection.loadTableOptions(e))}),500)}))},C=function(e,t){var a;n(Object(r.__assign)(Object(r.__assign)({},i),((a={})[e]=t,a)))},E=function(e){for(var t=i,a=0;a<e.length;a++)t[e[a].key]=e[a].value;n(t)},w={Table:{title:"Table",description:"Choose your own table to gather data from",content:x.a.createElement(x.a.Fragment,null,x.a.createElement(W,{updateQuery:C,loadTableOptions:_,value:i.tableName}),x.a.createElement(G,{query:i,updateQuery:C,datasource:l}),x.a.createElement(H,{query:i,updateQuery:C,datasource:l,sysparamTypeOptions:f,loadChoices:O}),x.a.createElement($,{loadOptions:b,value:i.sortBy,updateQuery:C,directionValue:i.sortDirection}),x.a.createElement(z,{defaultValue:i.rowLimit,updateQuery:C}),x.a.createElement(Z,{defaultValue:i.page,updateQuery:C}),x.a.createElement(ee,{value:i.getAlertCount,updateQuery:C}))},Aggregate:{title:"Aggregate",description:"Group by and apply aggregate functions to table data",content:x.a.createElement(x.a.Fragment,null,x.a.createElement(W,{updateQuery:C,loadTableOptions:_,value:i.tableName}),x.a.createElement(K,{query:i,updateQuery:C,datasource:l}),x.a.createElement(U,{options:v,value:i.selectedAggregateType,updateQuery:C,defaultColumnValue:i.aggregateColumn}),x.a.createElement(q,{updateQuery:C,defaultValue:i.sysparam_query}),x.a.createElement(z,{defaultValue:i.rowLimit,updateQuery:C}))},Alerts:{title:"Alerts",description:"Get Alerts",content:x.a.createElement(x.a.Fragment,null,x.a.createElement(I,{loadOptions:y,value:i.selectedServiceList,updateQuery:C}),x.a.createElement(F,{loadOptions:g,value:i.selectedSourceList,updateQuery:C}),x.a.createElement(P,{options:p,value:i.selectedAlertTypeList,updateQuery:C}),x.a.createElement(Q,{options:d,value:i.selectedAlertStateList,updateQuery:C}),x.a.createElement(q,{updateQuery:C,defaultValue:i.sysparam_query}),x.a.createElement(re,{query:i,updateQuery:C,datasource:l,replaceMultipleVariables:function(e){for(var t,a=e.indexOf("$"),n=function(){var e={};return Object.values(Object(o.getTemplateSrv)().getVariables()).forEach((function(t){if("adhoc"!==t.type&&"interval"!==t.type){var a=t,n=a.current.value;if("$__all"===n||Object(u.isEqual)(n,["$__all"]))if(null===a.allValue||""===a.allValue){for(var r="",l=1;l<a.options.length;l++)r+=a.options[l].value+",";","===r.charAt(r.length-1)&&(r=r.substring(0,r.length-1)),n=r}else n=a.allValue;e[a.id]={text:a.current.text,value:n}}})),e}();-1!==a;){var r=-1===e.indexOf("^",a)?e.length:e.indexOf("^",a),l=e.substring(a,r),i=l,s=("$"===(t=l).charAt(0)&&"{"===(t=t.substring(1)).charAt(0)&&"}"===t.charAt(t.length-1)&&(t=t.substring(1,t.length-1)),t);void 0!==n[s]&&(i=n[s].value),a=(e=e.replace(l,i)).indexOf("$")}return e}}),x.a.createElement(z,{defaultValue:i.rowLimit,updateQuery:C}),x.a.createElement(Z,{defaultValue:i.page,updateQuery:C}),x.a.createElement(ne,{value:i.grafanaTimerange,updateQuery:C}))},Anomaly:{title:"Anomaly",description:"Parse values out of Alert Anomalies table",content:x.a.createElement(x.a.Fragment,null,x.a.createElement(W,{updateQuery:C,loadTableOptions:_,value:i.tableName}),x.a.createElement(G,{query:i,updateQuery:C,datasource:l}),x.a.createElement(H,{query:i,updateQuery:C,datasource:l,sysparamTypeOptions:f,loadChoices:O}),x.a.createElement($,{loadOptions:b,value:i.sortBy,updateQuery:C,directionValue:i.sortDirection}),x.a.createElement(z,{defaultValue:i.rowLimit,updateQuery:C}),x.a.createElement(Z,{defaultValue:i.page,updateQuery:C}))},Changes:{title:"Changes",description:"Get Changes",content:x.a.createElement(x.a.Fragment,null,x.a.createElement(I,{loadOptions:y,value:i.selectedServiceList,updateQuery:C}),x.a.createElement(F,{loadOptions:g,value:i.selectedSourceList,updateQuery:C}),x.a.createElement(R,{options:m,value:i.selectedChangeTypeList,updateQuery:C}),x.a.createElement(q,{updateQuery:C,defaultValue:i.sysparam_query}),x.a.createElement(z,{defaultValue:i.rowLimit,updateQuery:C}),x.a.createElement(Z,{defaultValue:i.page,updateQuery:C}),x.a.createElement(ne,{value:i.grafanaTimerange,updateQuery:C}))},Geohash_Map:{title:"GeoHash Map",description:"Get map data from AWS or Azure",content:x.a.createElement(x.a.Fragment,null,x.a.createElement(W,{updateQuery:C,loadTableOptions:_,value:i.tableName}),x.a.createElement(K,{query:i,updateQuery:C,datasource:l}),x.a.createElement(q,{updateQuery:C,defaultValue:i.sysparam_query}))},Live_Agent_Data:{title:"Live Agent Data",description:"Get Live Data from your ACC Agents",content:x.a.createElement(x.a.Fragment,null,x.a.createElement(k,{updateQuery:C,defaultValue:i.live_osquery}))},Log_Data:{title:"Log Data",description:"Get log data",content:x.a.createElement(x.a.Fragment,null,x.a.createElement(ae,{value:i.compressLogs,updateQuery:C}),x.a.createElement(H,{query:i,updateQuery:C,datasource:l,sysparamTypeOptions:f,loadChoices:O}),x.a.createElement(Y,{updateQuery:C,defaultValue:i.elasticSearch}),x.a.createElement($,{loadOptions:b,value:i.sortBy,updateQuery:C,directionValue:i.sortDirection}),x.a.createElement(z,{defaultValue:i.rowLimit,updateQuery:C}),x.a.createElement(Z,{defaultValue:i.page,updateQuery:C}))},Metrics:{title:"Metrics",description:"Get Timeseries metrics",content:x.a.createElement(x.a.Fragment,null,x.a.createElement(I,{loadOptions:y,value:i.selectedServiceList,updateQuery:C}),x.a.createElement(F,{loadOptions:g,value:i.selectedSourceList,updateQuery:C}),x.a.createElement(j,{loadOptions:function(e){return new Promise((function(t){setTimeout((function(){t(l.snowConnection.loadResourceOptions(i.selectedSourceList,e))}),500)}))},value:i.selectedMetricTypeList,updateQuery:C}),x.a.createElement(L,{loadOptions:function(e){return new Promise((function(t){setTimeout((function(){t(l.snowConnection.loadMetricOptions(i.selectedSourceList,e))}),500)}))},value:i.selectedMetricNameList,updateQuery:C}),x.a.createElement(N,{options:s,value:i.selectedMetricAnomalyList,updateQuery:C}),x.a.createElement(q,{updateQuery:C,defaultValue:i.sysparam_query}))},Outage_Status:{title:"Outage Status",description:"Gathers business service status over the last 90 days",content:x.a.createElement(x.a.Fragment,null,x.a.createElement(I,{loadOptions:y,value:i.selectedServiceList,updateQuery:C}),x.a.createElement(X,{value:i.showPercent,updateQuery:C}),x.a.createElement(q,{updateQuery:C,defaultValue:i.sysparam_query}),x.a.createElement(z,{defaultValue:i.rowLimit,updateQuery:C}),x.a.createElement(Z,{defaultValue:i.page,updateQuery:C}),x.a.createElement(ne,{value:i.grafanaTimerange,updateQuery:C}))},Row_Count:{title:"Row Count",description:"Get row count from query",content:x.a.createElement(x.a.Fragment,null,x.a.createElement(W,{updateQuery:C,loadTableOptions:_,value:i.tableName}),x.a.createElement(q,{updateQuery:C,defaultValue:i.sysparam_query}))},Topology:{title:"Topology",description:"Get Topology",content:x.a.createElement(x.a.Fragment,null,x.a.createElement(D,{loadOptions:y,value:i.selectedServiceList,updateQuery:C}),x.a.createElement(M,{updateQuery:C,defaultValue:i.topology_parent_depth}),x.a.createElement(B,{updateQuery:C,defaultValue:i.topology_child_depth}),x.a.createElement(q,{updateQuery:C,defaultValue:i.sysparam_query}))},Trend_Data:{title:"Trend Data",description:"Get timeseries data based on a time trend",content:x.a.createElement(x.a.Fragment,null,x.a.createElement(W,{updateQuery:C,loadTableOptions:_,value:i.tableName}),x.a.createElement(H,{query:i,updateQuery:C,datasource:l,sysparamTypeOptions:f,loadChoices:O}),x.a.createElement(Y,{updateQuery:C,defaultValue:i.elasticSearch}),x.a.createElement(K,{query:i,updateQuery:C,datasource:l}),x.a.createElement(J,{query:i,updateQuery:C,trendByOptions:h,datasource:l}))}};return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.HorizontalGroup,{justify:"space-between"},x.a.createElement(A.InlineFieldRow,{style:{paddingTop:"8px"}},x.a.createElement(A.InlineField,{label:"Query Category",labelWidth:20},x.a.createElement(A.Select,{className:"min-width-10 max-width-30",options:function(){var e=[];for(var t in w){var a=w[t];e.push({label:a.title,value:t,description:a.description})}return e}(),value:i.selectedQueryCategory,onChange:function(e){"Anomaly"===e.label?E([{key:"tableName",value:{label:"Alert Anomaly",value:"em_alert_anomaly",description:"em_alert_anomaly"}},{key:"selectedQueryCategory",value:e}]):C("selectedQueryCategory",e)},menuPlacement:"bottom",maxMenuHeight:220}))),x.a.createElement(te,{value:i.cacheOverride,updateQuery:C})),w[null!==(t=i.selectedQueryCategory.value)&&void 0!==t?t:""].content)};a.d(t,"plugin",(function(){return ie}));var ie=new n.DataSourcePlugin(S).setConfigEditor((function(e){var t=e.options,a=e.onOptionsChange;""===t.url&&(t.url="https://<instance_name>.service-now.com/"),void 0===t.jsonData.apiPath&&(t.jsonData.apiPath="/api/snc/grafana_api"),void 0===t.jsonData.cacheTimeout&&(t.jsonData.cacheTimeout=60),void 0===t.jsonData.imageURL&&(t.jsonData.imageURL="https://yiij743y0gi4fteri1asp7p6-wpengine.netdna-ssl.com/wp-content/uploads/2019/03/RegoLink-integration-icons-01.png");var n=function(e,n){var l;a(Object(r.__assign)(Object(r.__assign)({},t),{jsonData:Object(r.__assign)(Object(r.__assign)({},t.jsonData),(l={},l[e]=n,l))}))};return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.Alert,{title:"Need more information?",severity:"info",elevated:!0},x.a.createElement(A.VerticalGroup,null,x.a.createElement("p",null,"Local documentation can be found in Configuration => Plugins on this plugin's page"),x.a.createElement("p",null,"Or"," ",x.a.createElement("a",{href:"https://github.com/optimizca/servicenow-grafana/blob/main/README.md"},"Click here to view the documentation on GitHub")))),x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{labelWidth:20,label:"Logo URL",tooltip:"To access this value in each dashboard, create a variable query using namespace: global_image."},x.a.createElement(A.Input,{defaultValue:void 0===t.jsonData.imageURL?"":t.jsonData.imageURL,onBlur:function(e){return n("imageURL",e.target.value)},width:60}))),x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{labelWidth:20,label:"API Path"},x.a.createElement(A.Input,{defaultValue:void 0===t.jsonData.apiPath?"":t.jsonData.apiPath,onBlur:function(e){return n("apiPath",e.target.value)},width:40}))),x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{labelWidth:20,label:"Cache Timeout",tooltip:"Number of seconds to cache a request for. This can be overridden in the query panel."},x.a.createElement(A.Select,{value:t.jsonData.cacheTimeout,options:[{label:"30m",value:1800},{label:"15m",value:900},{label:"5m",value:300},{label:"2m",value:120},{label:"60s",value:60},{label:"30s",value:30},{label:"5s",value:5}],allowCustomValue:!1,backspaceRemovesValue:!1,isClearable:!1,isSearchable:!0,isMulti:!1,onChange:function(e){return n("cacheTimeout",e.value)}}))),x.a.createElement(A.DataSourceHttpSettings,{defaultUrl:"https://<instance_name>.service-now.com/",dataSourceConfig:t,showAccessOptions:!0,sigV4AuthToggleEnabled:!1,showForwardOAuthIdentityOption:!1,onChange:function(e){var t="";-1!==e.url.indexOf("https://")?t=e.url.substring(8,e.url.indexOf(".service-now",8)):-1!==e.url.indexOf("http://")&&(t=e.url.substring(7,e.url.indexOf(".service-now",7))),e.jsonData.instanceName=t,a(e)}}))})).setQueryEditor((function(e){return x.a.createElement(le,Object(r.__assign)({},e))})).setVariableQueryEditor((function(e){var t=e.onChange,a=e.query,n=Object(r.__read)(Object(V.useState)(a),2),l=n[0],i=n[1],o=function(){t(l,l.rawQuery+" ("+l.namespace+")")},u=function(e,t){var a;i(Object(r.__assign)(Object(r.__assign)({},l),((a={})[e]=t,a)))};return x.a.createElement(x.a.Fragment,null,x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Namespace",labelWidth:20},x.a.createElement(A.Select,{options:[{label:"global_image",value:"global_image"},{label:"global_instance_name",value:"global_instance_name"},{label:"metric_names",value:"metric_names"},{label:"golden_metric_names",value:"golden_metric_names"},{label:"custom_kpis",value:"custom_kpis"},{label:"generic",value:"generic"},{label:"nested_cis",value:"nested_cis"},{label:"nested_classes",value:"nested_classes"},{label:"tagKeys",value:"tagKeys"},{label:"tagValues",value:"tagValues"}],value:l.namespace,onChange:function(e){return u("namespace",e.value)},allowCustomValue:!1,isClearable:!1,isSearchable:!0,onBlur:o,width:30}))),x.a.createElement(A.InlineFieldRow,null,x.a.createElement(A.InlineField,{label:"Query",labelWidth:20},x.a.createElement(A.Input,{name:"rawQuery",onChange:function(e){return u("rawQuery",e.target.value)},onBlur:o,value:l.rawQuery,width:190}))))}))}])}));
//# sourceMappingURL=module.js.map