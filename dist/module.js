/*! For license information please see module.js.LICENSE.txt */
define(["react","@grafana/ui","@grafana/data","@grafana/runtime","lodash"],(function(e,t,a,n,r){return function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a(a.s=54)}([function(t,a){t.exports=e},function(e,a){e.exports=t},function(e,t){e.exports=a},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,a){var n=a(11),r=a(30),l=a(31),i=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?r(e):l(e)}},function(e,t,a){var n=a(12),r="object"==typeof self&&self&&self.Object===Object&&self,l=n||r||Function("return this")();e.exports=l},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t){e.exports=function(e){return e}},function(e,t,a){var n=a(6),r=a(5);e.exports=function(e){if(!r(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,a){var n=a(7).Symbol;e.exports=n},function(e,t,a){(function(t){var a="object"==typeof t&&t&&t.Object===Object&&t;e.exports=a}).call(this,a(29))},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,a){var n=a(10),r=a(15);e.exports=function(e){return null!=e&&r(e.length)&&!n(e)}},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t){var a=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&a.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,a){var n=a(20),r=a(13),l=a(37),i=a(38),o=Object.prototype,u=o.hasOwnProperty,s=n((function(e,t){e=Object(e);var a=-1,n=t.length,s=n>2?t[2]:void 0;for(s&&l(t[0],t[1],s)&&(n=1);++a<n;)for(var c=t[a],p=i(c),d=-1,m=p.length;++d<m;){var v=p[d],f=e[v];(void 0===f||r(f,o[v])&&!u.call(e,v))&&(e[v]=c[v])}return e}));e.exports=s},function(e,t,a){"use strict";function n(){var e=Object.create(null),t=0,a=0,n=0,r=!1;function l(t){n--,delete e[t]}this.put=function(t,a,r,i){if(void 0!==r&&("number"!=typeof r||isNaN(r)||r<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==i&&"function"!=typeof i)throw new Error("Cache timeout callback must be a function");var o=e[t];o?clearTimeout(o.timeout):n++;var u={value:a,expire:r+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){l(t),i&&i(t,a)}.bind(this),r)),e[t]=u,a},this.del=function(t){var a=!0,n=e[t];return n?(clearTimeout(n.timeout),!isNaN(n.expire)&&n.expire<Date.now()&&(a=!1)):a=!1,a&&l(t),a},this.clear=function(){for(var l in e)clearTimeout(e[l].timeout);n=0,e=Object.create(null),r&&(t=0,a=0)},this.get=function(l){var i=e[l];if(void 0!==i){if(isNaN(i.expire)||i.expire>=Date.now())return r&&t++,i.value;r&&a++,n--,delete e[l]}else r&&a++;return null},this.size=function(){return n},this.memsize=function(){var t,a=0;for(t in e)a++;return a},this.debug=function(e){r=e},this.hits=function(){return t},this.misses=function(){return a},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var a in e){var n=e[a];t[a]={value:n.value,expire:n.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,a){var n=JSON.parse(t),r=Date.now(),l=a&&a.skipDuplicates;for(var i in n)if(n.hasOwnProperty(i)){if(l)if(e[i])continue;var o=n[i],u=o.expire-r;if(u<=0){this.del(i);continue}u=u>0?u:void 0,this.put(i,o.value,u)}return this.size()}}e.exports=new n,e.exports.Cache=n},function(e,t,a){var n=a(9),r=a(21),l=a(23);e.exports=function(e,t){return l(r(e,t,n),e+"")}},function(e,t,a){var n=a(22),r=Math.max;e.exports=function(e,t,a){return t=r(void 0===t?e.length-1:t,0),function(){for(var l=arguments,i=-1,o=r(l.length-t,0),u=Array(o);++i<o;)u[i]=l[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=l[i];return s[t]=a(u),n(e,this,s)}}},function(e,t){e.exports=function(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}},function(e,t,a){var n=a(24),r=a(36)(n);e.exports=r},function(e,t,a){var n=a(25),r=a(26),l=a(9),i=r?function(e,t){return r(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:l;e.exports=i},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t,a){var n=a(27),r=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=r},function(e,t,a){var n=a(28),r=a(35);e.exports=function(e,t){var a=r(e,t);return n(a)?a:void 0}},function(e,t,a){var n=a(10),r=a(32),l=a(5),i=a(34),o=/^\[object .+?Constructor\]$/,u=Function.prototype,s=Object.prototype,c=u.toString,p=s.hasOwnProperty,d=RegExp("^"+c.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!l(e)||r(e))&&(n(e)?d:o).test(i(e))}},function(e,t){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch(e){"object"==typeof window&&(a=window)}e.exports=a},function(e,t,a){var n=a(11),r=Object.prototype,l=r.hasOwnProperty,i=r.toString,o=n?n.toStringTag:void 0;e.exports=function(e){var t=l.call(e,o),a=e[o];try{e[o]=void 0;var n=!0}catch(e){}var r=i.call(e);return n&&(t?e[o]=a:delete e[o]),r}},function(e,t){var a=Object.prototype.toString;e.exports=function(e){return a.call(e)}},function(e,t,a){var n,r=a(33),l=(n=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!l&&l in e}},function(e,t,a){var n=a(7)["__core-js_shared__"];e.exports=n},function(e,t){var a=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return a.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t){var a=Date.now;e.exports=function(e){var t=0,n=0;return function(){var r=a(),l=16-(r-n);if(n=r,l>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,a){var n=a(13),r=a(14),l=a(16),i=a(5);e.exports=function(e,t,a){if(!i(a))return!1;var o=typeof t;return!!("number"==o?r(a)&&l(t,a.length):"string"==o&&t in a)&&n(a[t],e)}},function(e,t,a){var n=a(39),r=a(50),l=a(14);e.exports=function(e){return l(e)?n(e,!0):r(e)}},function(e,t,a){var n=a(40),r=a(41),l=a(43),i=a(44),o=a(16),u=a(46),s=Object.prototype.hasOwnProperty;e.exports=function(e,t){var a=l(e),c=!a&&r(e),p=!a&&!c&&i(e),d=!a&&!c&&!p&&u(e),m=a||c||p||d,v=m?n(e.length,String):[],f=v.length;for(var h in e)!t&&!s.call(e,h)||m&&("length"==h||p&&("offset"==h||"parent"==h)||d&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||o(h,f))||v.push(h);return v}},function(e,t){e.exports=function(e,t){for(var a=-1,n=Array(e);++a<e;)n[a]=t(a);return n}},function(e,t,a){var n=a(42),r=a(8),l=Object.prototype,i=l.hasOwnProperty,o=l.propertyIsEnumerable,u=n(function(){return arguments}())?n:function(e){return r(e)&&i.call(e,"callee")&&!o.call(e,"callee")};e.exports=u},function(e,t,a){var n=a(6),r=a(8);e.exports=function(e){return r(e)&&"[object Arguments]"==n(e)}},function(e,t){var a=Array.isArray;e.exports=a},function(e,t,a){(function(e){var n=a(7),r=a(45),l=t&&!t.nodeType&&t,i=l&&"object"==typeof e&&e&&!e.nodeType&&e,o=i&&i.exports===l?n.Buffer:void 0,u=(o?o.isBuffer:void 0)||r;e.exports=u}).call(this,a(17)(e))},function(e,t){e.exports=function(){return!1}},function(e,t,a){var n=a(47),r=a(48),l=a(49),i=l&&l.isTypedArray,o=i?r(i):n;e.exports=o},function(e,t,a){var n=a(6),r=a(15),l=a(8),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,e.exports=function(e){return l(e)&&r(e.length)&&!!i[n(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,a){(function(e){var n=a(12),r=t&&!t.nodeType&&t,l=r&&"object"==typeof e&&e&&!e.nodeType&&e,i=l&&l.exports===r&&n.process,o=function(){try{var e=l&&l.require&&l.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=o}).call(this,a(17)(e))},function(e,t,a){var n=a(5),r=a(51),l=a(52),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return l(e);var t=r(e),a=[];for(var o in e)("constructor"!=o||!t&&i.call(e,o))&&a.push(o);return a}},function(e,t){var a=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||a)}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var a in Object(e))t.push(a);return t}},,function(e,t,a){"use strict";a.r(t);var n=a(2),r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(e,t)};var l=function(){return(l=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function i(e,t,a,n){return new(a||(a=Promise))((function(r,l){function i(e){try{u(n.next(e))}catch(e){l(e)}}function o(e){try{u(n.throw(e))}catch(e){l(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,o)}u((n=n.apply(e,t||[])).next())}))}function o(e,t){var a,n,r,l,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return l={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function o(l){return function(o){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i;)try{if(a=1,n&&(r=2&l[0]?n.return:l[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){i.label=l[1];break}if(6===l[0]&&i.label<r[1]){i.label=r[1],r=l;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(l);break}r[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,o])}}}Object.create;function u(e,t){var a="function"==typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,r,l=a.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=l.next()).done;)i.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(a=l.return)&&a.call(l)}finally{if(r)throw r.error}}return i}function s(e,t,a){if(a||2===arguments.length)for(var n,r=0,l=t.length;r<l;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}Object.create;var c=a(18),p=a.n(c),d=a(3),m=a(4),v=a.n(m),f={selectedQueryCategory:{label:"Metrics",value:"Metrics",description:"Get Timeseries metrics."},basic_sysparam:[{1:null,2:null,3:null,4:null}],getAlertCount:{label:"No",value:"false"},cacheOverride:"",compressLogs:!1,grafanaTimerange:!1,sortDirection:"ASC",page:0,rowLimit:"9999"},h=a(19),g=a.n(h),y=["sys_created_on","created_on","last_event_time","sys_updated_on","time","start_time","end_time","Updated"];function b(e,t){var a=Object(d.getTemplateSrv)().replace(e,t,"csv"),n=a.indexOf(",");if(n>=0){for(;n>=0;)n=(a=a.replace(",","|")).indexOf(",");a="("+a+")"}return a.startsWith("(")&&a.endsWith(")")?"/"+a+"/":a}function C(e,t){return Object(d.getTemplateSrv)().replace(e,t,"csv")}function w(e,t,a,r,l){var i,o={name:n.TIME_SERIES_TIME_FIELD_NAME,type:n.FieldType.time,config:{custom:{}},values:new n.ArrayVector(e.map((function(e){return e[1]})))};i=(n.FieldType.string,new n.ArrayVector(e.map((function(e){return e[0]}))));var u=[o,{name:n.TIME_SERIES_VALUE_FIELD_NAME,type:null!=l?l:n.FieldType.number,labels:{},config:{displayName:t,custom:{}},values:i}];return{name:t,refId:a.refId,fields:u,length:e.length}}function E(e){1}function T(e){return")"===e.charAt(e.length-2)&&"("===e.charAt(1)&&(e=e.charAt(0)+e.slice(2,-2)+e.charAt(e.length-1)),e}function O(e){var t="";if(1===e.length)return e[0];if("string"==typeof e)return e;for(var a=0;a<e.length;a++)t+="|"+e[a];return"|"===t.charAt(0)&&(t="/"+(t=t.substring(1,t.length))+"/"),t}var S,_=a(4),V=(S=_)&&S.__esModule?S:{default:S};var x=function(){function e(e,t,a,n){this.requestOptions={headers:e,withCredentials:t,url:a},this.cacheTimeout=n,this.cache=new g.a.Cache}return e.prototype.cachedGet=function(e,t,a,n,r,l,s){return i(this,void 0,void 0,(function(){var r,i,s,c,p,m,v,f,h,g,y,b,C,w,E,T,O;return o(this,(function(o){if(r=60,r=void 0!==n&&n?n:this.cacheTimeout,i=this.requestOptions.url+t,s=i+="/body/"+l,a&&Object.keys(a).length>0&&(i=i+(i.search(/\?/)>=0?"&":"?")+a.map((function(e){var t=u(e,2),a=t[0],n=t[1];return encodeURIComponent(a)+"="+encodeURIComponent(n)})).join("&")),this.lastCacheDuration!==r&&this.cache.del(i),this.lastCacheDuration=r,!(c=this.cache.get(i))&&i.includes("?"))for(p=this.cache.keys(),m=0;m<p.length;m++)if((v=p[m]).includes(s)&&v.includes("?")&&(f=(f=v.substring(v.indexOf("?")+1,v.length)).split("&"),h=f[0].substring(f[0].indexOf("=")+1,f[0].length),g=f[1].substring(f[1].indexOf("=")+1,f[1].length),y=(y=i.substring(i.indexOf("?")+1,i.length)).split("&"),b=y[0].substring(y[0].indexOf("=")+1,y[0].length),C=y[1].substring(y[1].indexOf("=")+1,y[1].length),E=C-g,(w=b-h)>=0&&w<=1e3*r&&E<=1e3*r)){c=this.cache.get(v);break}return c?[2,Promise.resolve(c)]:(T="?"+a.map((function(e){var t=u(e,2),a=t[0],n=t[1];return encodeURIComponent(a)+"="+encodeURIComponent(n)})).join("&"),O="","GET"===e?O=Object(d.getBackendSrv)().get(this.requestOptions.url+t,T):"POST"===e&&(O=Object(d.getBackendSrv)().post(this.requestOptions.url+t+T,l)),this.cache.put(i,O,1e3*r),[2,O])}))}))},e.prototype.request=function(e){e.withCredentials=this.requestOptions.withCredentials,e.headers=this.requestOptions.headers;var t=e.url;e.url=this.requestOptions.url+t;var a=t.indexOf("?");-1===a&&(a=t.length);var n=t.substring(0,a),r=[];-1!==e.url.indexOf("?")&&e.url.substring(e.url.indexOf("?")+1,e.url.length).split("&").map((function(e){var t=[e.substring(0,e.indexOf("=")),e.substring(e.indexOf("=")+1,e.length)];r.push(t)}));if(e.cacheOverride){var l=e.cacheOverride.indexOf("s"),i=e.cacheOverride.indexOf("m");-1!==l?e.cacheOverride=parseInt(e.cacheOverride.substring(0,l),10):-1!==i&&(e.cacheOverride=60*parseInt(e.cacheOverride.substring(0,i),10))}return this.cachedGet(e.method,n,r,e.cacheOverride,e.headers,e.data,e)},e.prototype.mapAlertTags=function(e){var t=[];return e.map((function(e){if(void 0!==e.additional_info)try{var a=JSON.parse(e.additional_info);Object.keys(a).filter((function(e){return e.includes("tbac-")})).map((function(e){t.push({key:e,value:a[e]})}))}catch(e){}})),t=t.filter((function(e,t,a){return t===a.findIndex((function(t){return t.value===e.value&&t.key===e.key}))}))},e.prototype.mapChecksToValue=function(e){return V.default.map(e,(function(e,t){if(void 0!==e.name&&void 0!==e.id)return""!==e.name&&null!==e.name||(e.name="NULL"),""!==e.id&&null!==e.id||(e.id="NULL"),{text:e.name,value:e.id};var a=Object.keys(e);return""!==e[a[0]]&&null!==e[a[0]]||(e[a[0]]="NULL"),!a[1]||""!==e[a[1]]&&null!==e[a[1]]||(e[a[1]]="NULL"),{label:e[a[0]],value:a[1]?e[a[1]]:e[a[0]]}}))},e.prototype.mapChecksToValuePlusSuffix=function(e){return V.default.map(e,(function(e,t){var a=Object.keys(e);return{label:e[a[0]],value:a[1]?e[a[1]]:e[a[0]],suffix:e[a[2]]}}))},e.prototype.mapValueSuffixToColumns=function(e){var t=V.default.map(e,(function(e,t){return{label:e.label+":display",value:e.value+":d"}})),a=V.default.map(e,(function(e,t){return{label:e.label+":value",value:e.value+":v"}})),n=t.concat(a);return n=v.a.orderBy(n,["label"],["asc"])},e.prototype.mapValueAsSuffix=function(e,t){var a=V.default.map(e,(function(e){var a={label:t?e.label+" ("+e.type+")":e.label,value:e.value,description:e.value};return void 0!==e.options&&(a.options=V.default.map(e.options,(function(e){return{label:t?e.label+" ("+e.type+")":e.label,value:e.value,description:e.value}}))),a}));return a=v.a.orderBy(a,["label"],["asc"])},e.prototype.mapSuffixToLabel=function(e){return V.default.map(e,(function(e){return{label:e.label+" ("+e.suffix+")",value:e.value}}))},e.prototype.appendInstanceNameToResponse=function(e,t){return e=V.default.map(e,(function(e,a){return e.instanceName=t,e}))},e.prototype.mapToTextValue=function(e){return V.default.map(e,(function(e,t){return e&&e.text&&e.value?{text:e.text,value:e.value}:V.default.isObject(e)?{text:e,value:t}:{text:e,value:e}}))},e.prototype.mapOutageResponseToFrame=function(e,t){return e.map((function(e){var a=e.ci;return w(e.datapoints,a,t,0,n.FieldType.string)}))},e.prototype.mapTrendResponseToFrame=function(e,t){return Object.keys(e[0]).map((function(a){return w(e[0][a].datapoints,a,t,0,n.FieldType.number)}))},e.prototype.mapMetricsResponseToFrame=function(e,t){return e.map((function(e){var a=e.source+":"+e.metricName;return e.type.length>0&&(a+=":"+e.type),w(e.datapoints,a,t,0,n.FieldType.number)}))},e.prototype.mapAnamMetricsResponseToFrame=function(e,t){var a=e.map((function(a){var r=a.ciName,l=a.metricName;return a.data.map((function(a){var i=r+":"+l+":"+a.type;return 1!==e.length||"UPPER"!==a.type&&"LOWER"!==a.type||(i=a.type),function(e,t,a,r,l){var i,o={name:n.TIME_SERIES_TIME_FIELD_NAME,type:n.FieldType.time,config:{custom:{}},values:new n.ArrayVector(e.map((function(e){return e.x})))};i=(n.FieldType.string,new n.ArrayVector(e.map((function(e){return e.y}))));var u=[o,{name:n.TIME_SERIES_VALUE_FIELD_NAME,type:null!=l?l:n.FieldType.number,labels:{},config:{displayName:t,custom:{}},values:i}];return{name:t,refId:a.refId,fields:u,length:e.length}}(a.data,i,t,0,n.FieldType.number)}))}));return a=[].concat.apply([],a)},e.prototype.mapTextResponseToFrame=function(e,t){var a=new n.MutableDataFrame({fields:[],refId:t});if(E(),!(e.length>0))return[];e=e.map((function(e){if(e.additional_info){var t=JSON.parse(e.additional_info),a=Object.keys(t).filter((function(e){return e.includes("tbac-")}));e.tbac_data={};for(var n=0;n<a.length;n++)e.tbac_data[a[n]]=t[a[n]];return e.tbac_data=JSON.stringify(e.tbac_data),e}return e}));for(var r,l,i=Object.keys(e[0]),o=0;o<i.length;o++){var u=e.map((function(e){return e[i[o]]}));"new"!==i[o]&&"value:display"!==i[o]||(u=this.sanitizeValues(u));var s=n.FieldType.string;u.length>=0&&(r=u[0],l=i[o],s=y.includes(l)?n.FieldType.time:"number"==typeof r?n.FieldType.number:n.FieldType.string),a.addField({name:i[o],type:s,values:u})}return E(),a},e.prototype.createTopologyFrame=function(e,t){return[{columns:[{text:"type"},{type:"time",text:"Time"},{text:"app"},{text:"target_app"},{text:"req_rate"},{text:"error_rate"}],rows:e.rows,refId:t||void 0,meta:void 0}]},e.prototype.sanitizeValues=function(e){var t=[];return e.map((function(e){for(;-1!==e.indexOf("[code]");){var a=e.substring(0,e.indexOf("[code]")),n=e.substring(e.indexOf("[/code]")+7,e.length);if(-1!==e.indexOf("<a")){var r=e.substring(e.indexOf("<a"),e.indexOf("</a>",e.indexOf("<a"))),l=r.substring(r.indexOf(">")+1,r.length);-1!==l.indexOf("<")&&(l=l.substring(0,l.indexOf("<"))),e=a+l+n}else e=a+n}t.push(e)})),t},e}();function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var A=function(){function e(e){var t=e.basicAuth,a=e.withCredentials,n=e.url,r=e.apiPath,l=e.cacheTimeout;this.apiPath=r;var i={"Content-Type":"application/json"};"string"==typeof t&&t.length>0&&(i.Authorization=t),this.apiClient=new x(i,a,n,l)}return e.prototype.getTopology=function(e,t,a){var n=this;var r="";e.selectedServiceList&&e.selectedServiceList.value&&(r=C(e.selectedServiceList.value,t.scopedVars));var l="";e.topology_child_depth&&(l=b(e.topology_child_depth,t.scopedVars));var i="";e.topology_parent_depth&&(i=b(e.topology_parent_depth,t.scopedVars));var o="";e.sysparam_query&&(o=C(e.sysparam_query,t.scopedVars));var u='{"targets":[{"target":"'+r+'","child_depth":"'+l+'","parent_depth":"'+i+'","sysparm_query":"'+(o=this.removeFiltersWithAll(o))+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/topology",data:u,method:"POST",cacheOverride:""===a?null:a}).then((function(t){return E(),E(),E(),n.apiClient.createTopologyFrame(t,e.refId)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.getMetrics=function(e,t,a,n,r){var l=this;var i=!1,o="",u=[],s="",c=[],p="",d="";if(e.selectedSourceList){var m=[];e.selectedSourceList.map((function(e){m.push(b(e.value,n.scopedVars))})),o=O(m)}e.selectedMetricTypeList&&(e.selectedMetricTypeList.map((function(e){u.push(b(e.value,n.scopedVars))})),s=O(u)),e.selectedMetricNameList&&(e.selectedMetricNameList.map((function(e){c.push(b(e.value,n.scopedVars))})),p=O(c)),e.selectedMetricAnomalyList&&e.selectedMetricAnomalyList.value&&"true"===b(e.selectedMetricAnomalyList.value,n.scopedVars)&&(i=!0),e.sysparam_query&&(d=C(e.sysparam_query,n.scopedVars)),d=this.removeFiltersWithAll(d),p=T(p);var v='{"targets":[{"target":"'+(o=T(o))+'","resourceName":"'+s+'","metricName":"'+p+'","sysparm_query":"'+d+'"}]}',f=this.apiPath+"/v1/query/single_metric?startTime="+t+"&endTime="+a;return"*"===p&&(f=this.apiPath+"/v1/query/all_metrics?startTime="+t+"&endTime="+a),!0===i&&(f=this.apiPath+"/v1/query/anomaly_metrics?startTime="+t+"&endTime="+a),this.apiClient.request({url:f,data:v,method:"POST",cacheOverride:""===r?null:r}).then((function(t){return!0===i?l.apiClient.mapAnamMetricsResponseToFrame(t,e):l.apiClient.mapMetricsResponseToFrame(t,e)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.getAlerts=function(e,t,a,n,r,l){var i=this;var o="";e.selectedServiceList&&e.selectedServiceList.value&&(o=C(e.selectedServiceList.value,n.scopedVars));var u="";if(e.selectedSourceList){var s=[];e.selectedSourceList.map((function(e){s.push(b(e.value,n.scopedVars))})),u=O(s)}var c=o,p="All",d="none",m="";e.selectedAlertStateList&&e.selectedAlertStateList.value&&(p=e.selectedAlertStateList.value),e.selectedAlertTypeList&&("CI"===e.selectedAlertTypeList.value?(d="ci",c=u):"OS"===e.selectedAlertTypeList.value?(d="os",-1!==(c=u).indexOf("(")&&(c=c.substring(c.indexOf("(")+1,c.indexOf(")")))):"None"===e.selectedAlertTypeList.value&&(d="none")),e.sysparam_query&&(m=C(e.sysparam_query,n.scopedVars)),m=this.removeFiltersWithAll(m);var v="";if(e.tagKeys&&e.tagValues)for(var f=function(t){if("$"===e.tagKeys[t].value.charAt(0)){var a=C(e.tagKeys[t].value,n.scopedVars);a.split(",").map((function(t){for(var a=0;a<e.tagValues.length;a++)if("$"===e.tagValues[a].value.charAt(0)){(r=C(e.tagValues[a].value,n.scopedVars)).split(",").map((function(e){""!==t&&""!==e&&(v+=t+"="+e+",")}))}else{var r=e.tagValues[a].value;""!==t&&""!==r&&(v+=t+"="+r+",")}}))}else for(var r=e.tagKeys[t].value,l=0;l<e.tagValues.length;l++)if("$"===e.tagValues[l].value.charAt(0)){(i=C(e.tagValues[l].value,n.scopedVars)).split(",").map((function(e){""!==r&&""!==e&&(v+=r+"="+e+",")}))}else{var i=e.tagValues[l].value;""!==r&&""!==i&&(v+=r+"="+i+",")}},h=0;h<e.tagKeys.length;h++)f(h);","===v.charAt(v.length-1)&&(v=v.substring(0,v.length-1));var g="",y="";e.sortBy&&e.sortDirection&&e.sortBy.value&&(g=C(e.sortBy.value,n.scopedVars),y=e.sortDirection);var w=9999;e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(w=e.rowLimit);var T=0;e.page&&e.page>=0&&(T=e.page);var S="sys_updated_on";e.grafanaTimerangeColumn&&e.grafanaTimerangeColumn.value&&(S=C(e.grafanaTimerangeColumn.value,n.scopedVars));var _='{"targets":[{"target":"'+c+'","sysparm_query":"'+m+'","alertType":"'+d+'","alertState":"'+p+'","sortBy":"'+g+'","sortDirection":"'+y+'","limit":'+w+',"page":'+T+',"tagFilters":"'+v+'"}]}',V=this.apiPath+"/v1/query/alerts";return e.grafanaTimerange&&(V+="?startTime="+t+"&endTime="+a+"&timerangeColumn="+S),this.apiClient.request({url:V,data:_,method:"POST",cacheOverride:""===l?null:l}).then((function(t){return E(),E(),t=i.apiClient.appendInstanceNameToResponse(t,r),E(),i.apiClient.mapTextResponseToFrame(t,e.refId)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.getChanges=function(e,t,a,n,r){var l=this;var i="";e.selectedServiceList&&e.selectedServiceList.value&&(i=C(e.selectedServiceList.value,n.scopedVars));var o="";e.selectedSourceList&&e.selectedSourceList.value&&(o=C(e.selectedSourceList.value,n.scopedVars));var u=i,s="none";e.selectedChangeTypeList&&("CI"===e.selectedChangeTypeList.value?(s="ci",u=o):"None"===e.selectedChangeTypeList.value&&(s="none",u=""));var c="";e.sysparam_query&&(c=C(e.sysparam_query,n.scopedVars)),c=this.removeFiltersWithAll(c);var p="",d="";e.sortBy&&e.sortDirection&&e.sortBy.value&&(p=C(e.sortBy.value,n.scopedVars),d=e.sortDirection);var m=9999;e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(m=e.rowLimit);var v=0;e.page&&e.page>=0&&(v=e.page);var f="sys_updated_on";e.grafanaTimerangeColumn&&e.grafanaTimerangeColumn.value&&(f=C(e.grafanaTimerangeColumn.value,n.scopedVars));var h='{"targets":[{"target":"'+u+'","sysparm_query":"'+c+'","alertType":"'+s+'","sortBy":"'+p+'","sortDirection":"'+d+'","limit":'+m+',"page":'+v+"}]}";var g=this.apiPath+"/v1/query/changes";return e.grafanaTimerange&&(g+="?startTime="+t+"&endTime="+a+"&timerangeColumn="+f),this.apiClient.request({url:g,data:h,method:"POST",cacheOverride:""===r?null:r}).then((function(t){return E(),E(),l.apiClient.mapTextResponseToFrame(t,e.refId)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.getLiveACCData=function(e,t,a,n,r){e.live_osquery&&C(e.live_osquery,n.scopedVars);return this.apiClient.mapTextResponseToFrame({data:[{mem_in_megs:"740.39",name:"nscd",pid:"689"},{mem_in_megs:"333.76",name:"rsyslogd",pid:"29468"},{mem_in_megs:"125.67",name:"acc",pid:"30448"},{mem_in_megs:"109.54",name:"lvmetad",pid:"13729"},{mem_in_megs:"78.15",name:"xenstore-watch",pid:"707"}]},e.refId)},e.prototype.queryTable=function(e,t,a,n,r){var l=this;var i="";e.tableName&&e.tableName.value&&(i=b(e.tableName.value,n.scopedVars));var o="";e.selectedtableColumns&&(e.selectedtableColumns.map((function(e){o+=b(e.value,n.scopedVars)+","})),","===o.charAt(o.length-1)&&(o=o.substring(0,o.length-1)));var u="";if(-1!==e.basic_sysparam.constructor.toString().indexOf("Array"))for(var s=0;s<e.basic_sysparam.length;s++){var c=e.basic_sysparam[s],p="";c[1]&&(p=C(c[1].value,n.scopedVars));var d="";c[2]&&(d=c[2].value);var m="";c[3]&&(m=C(c[3].value,n.scopedVars));var v="";c[4]&&(v=c[4].value),u+=v+p+d+m}u=this.removeFiltersWithAll(u);var f=9999;e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(f=e.rowLimit);var h=0;e.page&&e.page>=0&&(h=e.page);var g="",y="";e.sortBy&&e.sortDirection&&e.sortBy.value&&(g=C(e.sortBy.value,n.scopedVars),y=e.sortDirection);var w="false";e.getAlertCount&&(w=e.getAlertCount.value);var T="sys_updated_on";e.grafanaTimerangeColumn&&e.grafanaTimerangeColumn.value&&(T=C(e.grafanaTimerangeColumn.value,n.scopedVars));var O='{"targets":[{"target":"'+i+'","columns":"'+o+'","sysparm":"'+u+'","limit":'+f+',"page":'+h+',"sortBy":"'+g+'","sortDirection":"'+y+'","getAlertCount":'+w+"}]}",S=this.apiPath+"/v1/query/table";return e.grafanaTimerange&&(S+="?startTime="+t+"&endTime="+a+"&timerangeColumn="+T),this.apiClient.request({url:S,data:O,method:"POST",cacheOverride:""===r?null:r}).then((function(t){return E(),E(),l.apiClient.mapTextResponseToFrame(t,e.refId)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.getRowCount=function(e,t,a,n,r){var l=this,i="";e.tableName&&e.tableName.value&&(i=b(e.tableName.value,n.scopedVars));var o="";e.sysparam_query&&(o=C(e.sysparam_query,n.scopedVars)),o=this.removeFiltersWithAll(o);var u="sys_updated_on";e.grafanaTimerangeColumn&&e.grafanaTimerangeColumn.value&&(u=C(e.grafanaTimerangeColumn.value,n.scopedVars));var s='{"targets":[{"target":"'+i+'","sysparm":"'+o+'"}]}',c=this.apiPath+"/v1/query/row_count";return e.grafanaTimerange&&(c+="?startTime="+t+"&endTime="+a+"&timerangeColumn="+u),this.apiClient.request({url:c,data:s,method:"POST",cacheOverride:""===r?null:r}).then((function(t){return E(),E(),l.apiClient.mapTextResponseToFrame(t,e.refId)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.getAggregateQuery=function(e,t,a,n,r){var l=this,i="",o="",u="",s="",c="";e.tableName&&e.tableName.value&&(i=b(e.tableName.value,n.scopedVars)),"string"==typeof e.groupBy?""!==e.groupBy&&(o=C(e.groupBy,n.scopedVars)):e.groupBy&&e.groupBy.value&&(o=C(e.groupBy.value,n.scopedVars)),e.selectedAggregateType&&e.selectedAggregateType.value&&(u=e.selectedAggregateType.value),e.aggregateColumn&&e.aggregateColumn.value&&(s=C(e.aggregateColumn.value,n.scopedVars)),e.sysparam_query&&(c=C(e.sysparam_query,n.scopedVars),c=this.removeFiltersWithAll(c));var p=9999;e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(p=e.rowLimit);var d="sys_updated_on";e.grafanaTimerangeColumn&&e.grafanaTimerangeColumn.value&&(d=C(e.grafanaTimerangeColumn.value,n.scopedVars));var m='{"targets":[{"target":"'+i+'","type":"'+u+'","column":"'+s+'","groupBy":"'+o+'","sysparm":"'+c+'","limit":'+p+"}]}",v=this.apiPath+"/v1/query/aggregate";return e.grafanaTimerange&&(v+="?startTime="+t+"&endTime="+a+"&timerangeColumn="+d),this.apiClient.request({url:v,data:m,method:"POST",cacheOverride:""===r?null:r}).then((function(t){return E(),E(),l.apiClient.mapTextResponseToFrame(t,e.refId)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.getGeohashMap=function(e,t,a){var n=this,r="",l="",i="";e.tableName&&e.tableName.value&&(r=b(e.tableName.value,t.scopedVars)),"string"==typeof e.groupBy?""!==e.groupBy&&(l=C(e.groupBy,t.scopedVars)):"object"===I(e.groupBy)&&null!==e.groupBy&&""!==e.groupBy.value&&(l=C(e.groupBy.value,t.scopedVars)),e.sysparam_query&&(i=C(e.sysparam_query,t.scopedVars));var o='{"targets":[{"target":"'+r+'","column":"'+l+'","sysparm":"'+(i=this.removeFiltersWithAll(i))+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/geohash_map",data:o,method:"POST",cacheOverride:""===a?null:a}).then((function(t){return E(),E(),n.apiClient.mapTextResponseToFrame(t,e.refId)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.queryLogData=function(e,t,a,n,r){var l=this,i=e.compressLogs,o="";if(-1!==e.basic_sysparam.constructor.toString().indexOf("Array"))for(var u=0;u<e.basic_sysparam.length;u++){var s=e.basic_sysparam[u],c="";s[1]&&(c=C(s[1].value,n.scopedVars));var p="";s[2]&&(p=s[2].value);var d="";s[3]&&(d=C(s[3].value,n.scopedVars));var m="";s[4]&&(m=s[4].value),o+=m+c+p+d}o=this.removeFiltersWithAll(o);var v=9999;e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(v=e.rowLimit);var f=0;e.page&&e.page>=0&&(f=e.page);var h="",g="";e.sortBy&&e.sortDirection&&e.sortBy.value&&(h=C(e.sortBy.value,n.scopedVars),g=e.sortDirection);var y="";e.elasticSearch&&(y=C(e.elasticSearch,n.scopedVars));var b='{"targets":[{"sysparm":"'+o+'","limit":'+v+',"page":'+f+',"sortBy":"'+h+'","sortDirection":"'+g+'","esSearch":"'+y+'","startTime":'+t+',"endTime":'+a+',"compressLog":'+i+"}]}";return this.apiClient.request({url:this.apiPath+"/v1/query/logs",data:b,method:"POST",cacheOverride:""===r?null:r}).then((function(t){return E(),E(),l.apiClient.mapTextResponseToFrame(t,e.refId)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.getTrendData=function(e,t,a,n,r){var l=this;var i="",o="",u="",s="",c="",p="",d=1;if(e.tableName&&e.tableName.value&&(i=b(e.tableName.value,n.scopedVars)),-1!==e.basic_sysparam.constructor.toString().indexOf("Array"))for(var m=0;m<e.basic_sysparam.length;m++){var v=e.basic_sysparam[m],f="";v[1]&&(f=C(v[1].value,n.scopedVars));var h="";v[2]&&(h=v[2].value);var g="";v[3]&&(g=C(v[3].value,n.scopedVars));var y="";v[4]&&(y=v[4].value),o+=y+f+h+g}o=this.removeFiltersWithAll(o),e.elasticSearch&&(u=C(e.elasticSearch,n.scopedVars)),"string"==typeof e.groupBy?""!==e.groupBy&&(s=C(e.groupBy,n.scopedVars)):"object"===I(e.groupBy)&&null!==e.groupBy&&""!==e.groupBy.value&&(s=C(e.groupBy.value,n.scopedVars)),e.selectedTrendColumn&&e.selectedTrendColumn.value&&(c=C(e.selectedTrendColumn.value,n.scopedVars)),e.selectedTrendBy&&e.selectedTrendBy.value&&(p=C(e.selectedTrendBy.value,n.scopedVars)),e.trendPeriod&&e.trendPeriod>0&&(d=e.trendPeriod);var w='{"targets":[{"target":"'+i+'","sysparm":"'+o+'","esSearch":"'+u+'","trendColumn":"'+c+'","trendBy":"'+p+'","period":'+d+',"groupBy":"'+s+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/trend?startTime="+t+"&endTime="+a,data:w,method:"POST",cacheOverride:""===r?null:r}).then((function(t){return E(),E(),l.apiClient.mapTrendResponseToFrame(t,e)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.getOutageStatus=function(e,t,a,n,r){var l=this,i="";e.selectedServiceList&&e.selectedServiceList.value&&(i=C(e.selectedServiceList.value,n.scopedVars));var o=!1;"boolean"==typeof e.showPercent&&(o=e.showPercent);var u="";e.sysparam_query&&(u=C(e.sysparam_query,n.scopedVars)),u=this.removeFiltersWithAll(u);var s=9999;e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(s=e.rowLimit);var c=0;e.page&&e.page>=0&&(c=e.page);var p='{"targets":[{"target":"'+i+'","showPercent":'+o+',"sysparm":"'+u+'","limit":'+s+',"page":'+c+"}]}";return this.apiClient.request({url:this.apiPath+"/v1/query/outage",data:p,method:"POST",cacheOverride:""===r?null:r}).then((function(t){return E(),E(),o?l.apiClient.mapTextResponseToFrame(t,e.refId):l.apiClient.mapOutageResponseToFrame(t,e)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.getAnomaly=function(e,t,a,n,r){var l=this;var i="";e.selectedtableColumns&&e.selectedtableColumns.length>0&&(e.selectedtableColumns.map((function(e){i+=b(e.value,n.scopedVars)+","})),","===i.charAt(i.length-1)&&(i=i.substring(0,i.length-1)));var o="";if(-1!==e.basic_sysparam.constructor.toString().indexOf("Array"))for(var u=0;u<e.basic_sysparam.length;u++){var s=e.basic_sysparam[u],c="";s[1]&&(c=C(s[1].value,n.scopedVars));var p="";s[2]&&(p=s[2].value);var d="";s[3]&&(d=C(s[3].value,n.scopedVars));var m="";s[4]&&(m=s[4].value),o+=m+c+p+d}o=this.removeFiltersWithAll(o);var v=9999;e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(v=e.rowLimit);var f=0;e.page&&e.page>=0&&(f=e.page);var h="",g="";e.sortBy&&e.sortDirection&&e.sortBy.value&&(h=C(e.sortBy.value,n.scopedVars),g=e.sortDirection);var y='{"targets":[{"columns":"'+i+'","sysparm":"'+o+'","limit":'+v+',"page":'+f+',"sortBy":"'+h+'","sortDirection":"'+g+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/anomaly",data:y,method:"POST",cacheOverride:""===r?null:r}).then((function(t){return E(),E(),l.apiClient.mapTextResponseToFrame(t,e.refId)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.getGenericVariable=function(e,t,a,n,r){var l=this,i='{"targets":[{"tableName":"'+e+'","nameColumn":"'+t+'","idColumn":"'+a+'","sysparm":"'+n+'","limit":'+r+"}]}";return this.apiClient.request({url:this.apiPath+"/v1/variable/generic",data:i,method:"POST"}).then((function(e){return E(),l.apiClient.mapChecksToValue(e)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.getMetricNamesInCIs=function(e,t){var a=this;var n=O(t),r='{"targets":[{"target":"'+(n=T(n))+'","metricType":"'+e+'"}]}',l=this.apiPath+"/v1/variable/metrics";return this.apiClient.request({url:l,data:r,method:"POST"}).then((function(e){return E(),a.apiClient.mapChecksToValue(e)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.getNestedCIS=function(e){var t=this,a='{"targets":[{"ci": "'+e.ci+'",\n      "parentDepth":"'+e.parentDepth+'",\n      "childDepth":"'+e.childDepth+'",\n      "sysparm":"'+e.sysparam+'",\n      "type":"ci"}]}';return this.apiClient.request({url:this.apiPath+"/v1/variable/nested_value",data:a,method:"POST"}).then((function(e){return E(),t.apiClient.mapChecksToValue(e)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.getNestedClasses=function(e){var t=this,a='{"targets":[{"ci": "'+e.ci+'",\n      "parentDepth":"'+e.parentDepth+'",\n      "childDepth":"'+e.childDepth+'",\n      "sysparm":"'+e.sysparam+'",\n      "type":"class"}]}';return this.apiClient.request({url:this.apiPath+"/v1/variable/nested_value",data:a,method:"POST"}).then((function(e){return E(),t.apiClient.mapChecksToValue(e)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.getMetricAnomalyOptions=function(){return[{label:"true",value:"true"},{label:"false",value:"false"}]},e.prototype.getAlertTypeOptions=function(){return[{label:"CI",value:"CI",description:"Get Alerts at the CI level"},{label:"Service",value:"Service",description:"Get Alerts at the Service level"},{label:"None",value:"None",description:"Ignore CI selection and use sysparam_query"}]},e.prototype.getAlertStateOptions=function(){return[{label:"Active",value:"Active",description:"Get Open and Reopen Alerts"},{label:"All",value:"All",description:"Get All alerts Open,Reopen, and Closed"}]},e.prototype.getChangeTypeOptions=function(){return[{label:"CI",value:"CI",description:"Get Changes at the CI level"},{label:"Service",value:"Service",description:"Get Changes at the Service level"},{label:"None",value:"None",description:"Ignore CI selection and use sysparam_query"}]},e.prototype.getAggregateTypeOptions=function(){return[{label:"AVG",value:"AVG"},{label:"COUNT",value:"COUNT"},{label:"MIN",value:"MIN"},{label:"MAX",value:"MAX"},{label:"STDDEV",value:"STDDEV"},{label:"SUM",value:"SUM"}]},e.prototype.getSysparamTypeOptions=function(){return[{label:"is",value:"=",description:"="},{label:"is not",value:"!=",description:"!="},{label:"starts with",value:"STARTSWITH",description:"STARTSWITH"},{label:"ends with",value:"ENDSWITH",description:"ENDSWITH"},{label:"contains",value:"LIKE",description:"LIKE"},{label:"does not contain",value:"NOT LIKE",description:"NOT LIKE"},{label:"is empty",value:"ISEMPTY",description:"ISEMPTY"},{label:"is not empty",value:"ISNOTEMPTY",description:"ISNOTEMPTY"},{label:"is anything",value:"ANYTHING",description:"ANYTHING"},{label:"is one of",value:"IN",description:"IN"},{label:"is not one of",value:"NOT IN",description:"NOT IN"},{label:"is empty string",value:"EMPTYSTRING",description:"EMPTYSTRING"},{label:"less than or is",value:"<=",description:"<="},{label:"greater than or is",value:">=",description:">="},{label:"between",value:"BETWEEN",description:"BETWEEN"},{label:"instance of",value:"INSTANCEOF",description:"INSTANCEOF"}]},e.prototype.getTrendByOptions=function(){return[{label:"Minute",value:"minute"},{label:"Week",value:"week"}]},e.prototype.loadServiceOptions=function(e){var t=this,a='{"targets":[{"target":"cmdb_ci_service","columns":"name:d,sys_id:v","sysparm":"operational_status=1^name!=All^nameLIKE'+(e||"")+'","limit":100,"sortBy":"name","sortDirection":"ASC"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:a,method:"POST"}).then((function(e){return E(),E(),E(t.apiClient.mapChecksToValue(e)),t.apiClient.mapChecksToValue(e)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.loadCIOptions=function(e,t){var a=this,n=t||"",r="";return r=e?'{"targets":[{"target":"em_impact_graph","columns":"child_name:d,child_id:v,child_id:d","sysparm":"business_service='+e+"^child_nameLIKE"+n+'","limit":100,"sortBy":"ci_name","sortDirection":"ASC"}]}':'{"targets":[{"target":"cmdb_ci","columns":"name:d,sys_id:v,sys_class_name:d","sysparm":"nameLIKE'+n+'^name!=NULL","limit":100,"sortBy":"cmdb_ci.name","sortDirection":"ASC"}]}',this.apiClient.request({url:this.apiPath+"/v1/query/table",data:r,method:"POST"}).then((function(e){E(),E();var t=a.apiClient.mapChecksToValuePlusSuffix(e);return E(),a.apiClient.mapSuffixToLabel(t)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.loadResourceOptions=function(e,t){var a=this,n="",r=t||"";e&&(n='{"targets":[{"target":"sa_metric_map","columns":"resource_id:d,resource_id:v","sysparm":"cmdb_ciIN'+e.map((function(e){return e.value}))+"^resource_idLIKE"+r+'^resource_id!=NULL","limit":100,"sortBy":"resource_id","sortDirection":"ASC"}]}');return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:n,method:"POST"}).then((function(e){E(),E();var t=[{label:"*",value:"*"}].concat(a.apiClient.mapChecksToValue(e));return t=t.filter((function(e,t,a){return t===a.findIndex((function(t){return t.value===e.value}))}))})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.loadMetricOptions=function(e,t){var a=this,n="",r=t||"";void 0!==e&&(n='{"targets":[{"target":"sa_metric_map","columns":"metric_type_id.metric_type_tiny_name:d,metric_type_id:v","sysparm":"cmdb_ciIN'+e.map((function(e){return e.value}))+"^metric_type_id.metric_type_tiny_nameLIKE"+r+'","limit":100,"sortBy":"","sortDirection":"ASC"}]}');return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:n,method:"POST"}).then((function(e){E(),E();var t=[{label:"*",value:"*"}].concat(a.apiClient.mapChecksToValue(e));return t=t.filter((function(e,t,a){return t===a.findIndex((function(t){return t.value===e.value}))}))})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.loadColumnChoices=function(e,t,a){var n=this,r='{"targets":[{"target":"sys_choice","columns":"label,value","sysparm":"name='+e+"^element!=NULL^elementLIKE"+t+"^labelLIKE"+a+'^language=en","limit":100,"sortBy":"label","sortDirection":"ASC"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:r,method:"POST"}).then((function(e){return E(),E(),n.apiClient.mapChecksToValue(e)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.getTableColumnOptions=function(e){var t=this;if(void 0!==e){var a='{"targets":[{"table":"'+e+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/select/table_columns",data:a,method:"POST"}).then((function(e){return E(),E(),t.apiClient.mapValueAsSuffix(e,!0)})).catch((function(e){throw new Error(e.data.error.message)}))}},e.prototype.loadTableOptions=function(e){var t=this,a='{"targets":[{"target":"sys_db_object","columns":"label,name","sysparm":"nameLIKE'+e+"^ORlabelLIKE"+e+'","limit":100}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:a,method:"POST"}).then((function(e){E(),E();var a=t.apiClient.mapChecksToValue(e);return E(),t.apiClient.mapValueAsSuffix(a,!1)})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.getTopologyCISummary=function(e){var t='{"targets":[{"target":"'+e+'"}]}';return this.apiClient.request({url:this.apiPath+"/query/ci_summary",data:t,method:"POST"}).then((function(e){return E(),E(),e.data}))},e.prototype.getAlertTags=function(e,t,a){var n=this;a||(a=9999),"Active"===e&&(t+="state!=Closed");var r='{"targets":[{"target":"em_alert","columns":"additional_info","sysparm":"'+t+'","limit":'+a+',"sortBy":"","sortDirection":"ASC"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:r,method:"POST"}).then((function(e){E(),E();var t=n.apiClient.mapAlertTags(e);return E(),t})).catch((function(e){throw new Error(e.data.error.message)}))},e.prototype.removeFiltersWithAll=function(e){for(var t=e.indexOf("*");-1!==t;){var a=e.substring(t+1),n=e.substring(0,t+1),r=n.lastIndexOf("^");-1===r&&(r=0),t=(e=(n=n.substring(0,r))+a).indexOf("*")}return e},e}(),F=function(e){function t(t){var a=e.call(this,t)||this,n={type:t.type,url:t.url,name:t.name,basicAuth:t.basicAuth,withCredentials:t.withCredentials,apiPath:t.jsonData.apiPath,cacheTimeout:t.jsonData.cacheTimeout};return a.globalImage=t.jsonData.imageURL,a.instanceName=t.jsonData.instanceName,a.apiPath=n.apiPath,a.snowConnection=new A(n),a.annotations={},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function a(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}(t,e),t.prototype.metricFindQuery=function(e,t){return i(this,void 0,void 0,(function(){var a,n,r,l,i,u,s,c,p,m,v,f,h,g,y,b,C,w;return o(this,(function(o){switch(o.label){case 0:return"global_image"===e.namespace?[2,[{label:this.globalImage,value:this.globalImage}]]:"global_instance_name"===e.namespace?[2,[{label:this.instanceName,value:this.instanceName}]]:"generic"===e.namespace?void 0!==e.rawQuery?(a=e.rawQuery.split("||"),n=void 0===a[0]?"":Object(d.getTemplateSrv)().replace(a[0],t.scopedVars,"csv"),r=void 0===a[1]?"":Object(d.getTemplateSrv)().replace(a[1],t.scopedVars,"csv"),l=void 0===a[2]?"":Object(d.getTemplateSrv)().replace(a[2],t.scopedVars,"csv"),y=void 0===a[3]?"":Object(d.getTemplateSrv)().replace(a[3],t.scopedVars,"csv"),b=void 0===a[4]?"9999":Object(d.getTemplateSrv)().replace(a[4],t.scopedVars,"csv"),[2,this.snowConnection.getGenericVariable(n,r,l,y,b)]):[2,[]]:"metric_names"===e.namespace?(i=Object(d.getTemplateSrv)().replace(e.rawQuery,t.scopedVars,"csv"),u=i.split(","),[2,this.snowConnection.getMetricNamesInCIs("",u)]):"golden_metric_names"===e.namespace?(i=Object(d.getTemplateSrv)().replace(e.rawQuery,t.scopedVars,"csv"),u=i.split(","),[2,this.snowConnection.getMetricNamesInCIs("GOLDEN",u)]):"custom_kpis"===e.namespace?(i=Object(d.getTemplateSrv)().replace(e.rawQuery,t.scopedVars,"csv"),u=i.split(","),[2,this.snowConnection.getMetricNamesInCIs("CUSTOM_KPIS",u)]):"nested_cis"===e.namespace?((s=e.rawQuery.split("||")).map((function(e,a){s[a]=Object(d.getTemplateSrv)().replace(e,t.scopedVars,"csv"),0===s[a].indexOf("$")&&(s=s.splice(a))})),c={ci:void 0===s[0]?"":s[0],parentDepth:void 0===s[1]?"":s[1],childDepth:void 0===s[2]?"":s[2],sysparam:void 0===s[3]?"":s[3]},[2,this.snowConnection.getNestedCIS(c)]):"nested_classes"===e.namespace?((p=e.rawQuery.split("||")).map((function(e,a){p[a]=Object(d.getTemplateSrv)().replace(e,t.scopedVars,"csv"),0===p[a].indexOf("$")&&(p=p.splice(a))})),m={ci:void 0===p[0]?"":p[0],parentDepth:void 0===p[1]?"":p[1],childDepth:void 0===p[2]?"":p[2],sysparam:void 0===p[3]?"":p[3]},[2,this.snowConnection.getNestedClasses(m)]):"tagKeys"!==e.namespace?[3,3]:void 0===e.rawQuery?[3,2]:((v=e.rawQuery.split("||")).map((function(e,a){v[a]=Object(d.getTemplateSrv)().replace(e,t.scopedVars,"csv"),0===v[a].indexOf("$")&&(v=v.splice(a))})),g=void 0===v[0]?"All":v[0],y=void 0===v[1]?"":v[1],b=void 0===v[2]?"9999":v[2],[4,this.snowConnection.getAlertTags(g,y,b)]);case 1:return C=o.sent(),(w=C.map((function(e){return{text:e.key,value:e.key}}))).unshift({text:"None",value:""}),[2,w];case 2:return[2,[]];case 3:return"tagValues"!==e.namespace?[3,6]:void 0===e.rawQuery?[3,5]:((f=e.rawQuery.split("||")).map((function(e,a){f[a]=Object(d.getTemplateSrv)().replace(e,t.scopedVars,"csv"),0===f[a].indexOf("$")&&(f=f.splice(a))})),h=void 0===f[0]?"":f[0],g=void 0===f[1]?"All":f[1],y=void 0===f[2]?"":f[2],b=void 0===f[3]?"9999":f[3],[4,this.snowConnection.getAlertTags(g,y,b)]);case 4:return C=(C=o.sent()).filter((function(e){if(h.includes(e.key))return e})),(w=C.map((function(e){return{text:e.value,value:e.value}}))).unshift({text:"None",value:""}),[2,w];case 5:return[2,[]];case 6:return[2]}}))}))},t.prototype.query=function(e){return i(this,void 0,Promise,(function(){var t,a,r,l,i=this;return o(this,(function(o){return t=e.range,a=t.from.valueOf(),r=t.to.valueOf(),l=v.a.map(e.targets,(function(t){if(t.hide)return[];var n=v.a.cloneDeep(t),l=p()(n,f),o=l.selectedQueryCategory.value,u=l.cacheOverride;switch(o){case"Topology":return i.snowConnection.getTopology(n,e,u);case"Metrics":return i.snowConnection.getMetrics(n,a,r,e,u);case"Alerts":return i.snowConnection.getAlerts(n,a,r,e,i.instanceName,u);case"Changes":return i.snowConnection.getChanges(n,a,r,e,u);case"Live_Agent_Data":return i.snowConnection.getLiveACCData(n,a,r,e,u);case"Table":return i.snowConnection.queryTable(n,a,r,e,u);case"Row_Count":return i.snowConnection.getRowCount(n,a,r,e,u);case"Aggregate":return i.snowConnection.getAggregateQuery(n,a,r,e,u);case"Geohash_Map":return i.snowConnection.getGeohashMap(n,e,u);case"Log_Data":return i.snowConnection.queryLogData(n,a,r,e,u);case"Trend_Data":return i.snowConnection.getTrendData(n,a,r,e,u);case"Outage_Status":return i.snowConnection.getOutageStatus(n,a,r,e,u);case"Anomaly":return i.snowConnection.getAnomaly(n,a,r,e,u);default:return[]}})),[2,Promise.all(v.a.flatten(l)).then(v.a.flatten).then((function(t){return{data:t,state:n.LoadingState.Done,key:e.requestId}}))]}))}))},t.prototype.testDatasource=function(){return this.snowConnection.apiClient.request({url:this.apiPath,method:"GET"}).then((function(){return{status:"success",message:"Data source connection is successful",title:"Success"}})).catch((function(e){return{status:"error",message:"Data source connection failed: "+e.statusText,title:"Error"}}))},t}(n.DataSourceApi),L=a(0),N=a.n(L),j=a(1),q=function(e){var t=e.loadOptions,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Service",labelWidth:20},N.a.createElement(j.AsyncSelect,{width:20,loadOptions:t,defaultOptions:!0,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return n("selectedServiceList",{label:e,value:e})},onChange:function(e){return n("selectedServiceList",e)},menuPlacement:"bottom",maxMenuHeight:200}))))},P=function(e){var t=e.loadOptions,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"CI",labelWidth:20},N.a.createElement(j.AsyncSelect,{width:20,loadOptions:t,value:a,defaultValue:a,isMulti:!0,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){var t=[];void 0!==a?(t=s([],u(a),!1))[t.length]={label:e,value:e}:t=[{label:e,value:e}],n("selectedSourceList",t)},onChange:function(e){return n("selectedSourceList",e)},menuPlacement:"bottom",maxMenuHeight:200}))))},Q=function(e){var t=e.loadOptions,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Resource ID",labelWidth:20},N.a.createElement(j.AsyncSelect,{width:20,loadOptions:t,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){var t=[];void 0!==a?(t=s([],u(a),!1))[t.length]={label:e,value:e}:t=[{label:e,value:e}],n("selectedMetricTypeList",t)},onChange:function(e){return n("selectedMetricTypeList",e)},maxMenuHeight:200}))))},R=function(e){var t=e.loadOptions,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Metric Name",labelWidth:20},N.a.createElement(j.AsyncSelect,{width:20,loadOptions:t,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){var t=[];void 0!==a?(t=s([],u(a),!1))[t.length]={label:e,value:e}:t=[{label:e,value:e}],n("selectedMetricNameList",t)},onChange:function(e){return n("selectedMetricNameList",e)},className:"coloredSelect",maxMenuHeight:200}))))},M=function(e){var t=e.options,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Anomaly",labelWidth:20},N.a.createElement(j.Select,{width:20,options:t,value:a,defaultValue:a,isClearable:!0,onChange:function(e){return n("selectedMetricAnomalyList",e)},maxMenuHeight:200}))))},D=function(e){var t=e.updateQuery,a=e.defaultValue;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Sysparam Query",labelWidth:20},N.a.createElement(j.Input,{name:"sysparam_query",width:20,defaultValue:a,onBlur:function(e){return t("sysparam_query",e.target.value)}}))))},B=function(e){var t=e.options,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Alert Type Filter",labelWidth:20},N.a.createElement(j.Select,{width:20,options:t,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,onChange:function(e){return n("selectedAlertTypeList",e)},maxMenuHeight:200}))))},k=function(e){var t=e.options,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Alert State Filter",labelWidth:20},N.a.createElement(j.Select,{width:20,options:t,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,onChange:function(e){return n("selectedAlertStateList",e)},maxMenuHeight:200}))))},W=function(e){var t=e.options,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Change Type Filter",labelWidth:20},N.a.createElement(j.Select,{width:20,options:t,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,onChange:function(e){return n("selectedChangeTypeList",e)},maxMenuHeight:200}))))},G=function(e){var t=e.loadOptions,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Starting Point",labelWidth:20},N.a.createElement(j.AsyncSelect,{width:20,loadOptions:t,defaultOptions:!0,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return n("selectedServiceList",{label:e,value:e})},onChange:function(e){return n("selectedServiceList",e)},menuPlacement:"bottom",maxMenuHeight:200}))))},H=function(e){var t=e.updateQuery,a=e.defaultValue;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Parent Depth",labelWidth:20},N.a.createElement(j.Input,{name:"parent_depth",width:20,defaultValue:a,onBlur:function(e){return t("topology_parent_depth",e.target.value)}}))))},K=function(e){var t=e.updateQuery,a=e.defaultValue;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Child Depth",labelWidth:20},N.a.createElement(j.Input,{name:"child_depth",width:20,defaultValue:a,onBlur:function(e){return t("topology_child_depth",e.target.value)}}))))},U=function(e){var t=e.updateQuery,a=e.defaultValue;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Osquery",labelWidth:20},N.a.createElement(j.Input,{name:"osquery",width:20,defaultValue:a,onBlur:function(e){return t("live_osquery",e.target.value)}}))))},$=function(e){var t=e.loadTableOptions,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Table Name",labelWidth:20},N.a.createElement(j.AsyncSelect,{prefix:N.a.createElement(j.Icon,{name:"table"}),loadOptions:t,className:"min-width-10 max-width-30",value:a,defaultValue:a,defaultOptions:!0,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return n("tableName",e)},onCreateOption:function(e){return n("tableName",{label:e,value:e})},menuPlacement:"bottom",maxMenuHeight:200}))))},z=function(e){var t=e.query,a=e.updateQuery,n=e.datasource,r=u(Object(L.useState)(t.selectedtableColumns),2),l=r[0],c=r[1],p=u(Object(L.useState)([{label:"Loading ...",value:""}]),2),d=p[0],m=p[1];return Object(L.useEffect)((function(){var e=[],a=!1;return function(){var r;i(this,void 0,void 0,(function(){return o(this,(function(i){switch(i.label){case 0:return[4,n.snowConnection.getTableColumnOptions(null===(r=t.tableName)||void 0===r?void 0:r.value)];case 1:return e=i.sent(),a||e.length>0&&(l&&l.length>0&&(e=e.concat(l)),m(e)),[2]}}))}))}(),function(){a=!0}}),[n.snowConnection,t.tableName,l]),N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Table Columns",labelWidth:20,tooltip:"Leave columns blank to return all columns in the dictionary"},N.a.createElement(j.Select,{prefix:N.a.createElement(j.Icon,{name:"columns"}),className:"min-width-10 max-width-30",options:d,value:l,defaultValue:l,isSearchable:!0,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){a("selectedtableColumns",e),c(e)},onCreateOption:function(e){var t=[];void 0!==l?(t=s([],u(l),!1))[t.length]={label:e,value:e}:t=[{label:e,value:e}],a("selectedtableColumns",t),c(t)},menuPlacement:"bottom",maxMenuHeight:200}))))},Y=function(e){var t=e.query,a=e.updateQuery,n=e.datasource,r=u(Object(L.useState)(t.groupBy),2),l=r[0],s=r[1],c=u(Object(L.useState)([{label:"Loading ...",value:""}]),2),p=c[0],d=c[1];return Object(L.useEffect)((function(){var e=[],a=!1;return function(){var r;i(this,void 0,void 0,(function(){return o(this,(function(l){switch(l.label){case 0:return[4,n.snowConnection.getTableColumnOptions(null===(r=t.tableName)||void 0===r?void 0:r.value)];case 1:return e=l.sent(),a||e.length>0&&d(e),[2]}}))}))}(),function(){a=!0}}),[n.snowConnection,t.tableName]),N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Group By",labelWidth:20,tooltip:"Select a column which will be used to group the results by."},N.a.createElement(j.Select,{width:20,options:p,value:l,defaultValue:l,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){a("groupBy",e),s(e)},onCreateOption:function(e){a("groupBy",{label:e,value:e}),s({label:e,value:e})},menuPlacement:"top",maxMenuHeight:200}))))},J=function(e){var t=e.query,a=e.updateQuery,n=e.datasource,r=n.snowConnection.getAggregateTypeOptions(),l=u(Object(L.useState)([{label:"Loading ...",value:""}]),2),c=l[0],p=l[1];return Object(L.useEffect)((function(){var e=[],a=!1;return function(){var r;i(this,void 0,void 0,(function(){return o(this,(function(l){switch(l.label){case 0:return[4,n.snowConnection.getTableColumnOptions(null===(r=t.tableName)||void 0===r?void 0:r.value)];case 1:return e=l.sent(),a||e.length>0&&(t.aggregateColumn&&t.aggregateColumn.length>0&&(e=e.concat(t.aggregateColumn)),p(e)),[2]}}))}))}(),function(){a=!0}}),[n.snowConnection,t.tableName,t.aggregateColumn]),N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Aggregate Function",labelWidth:20,tooltip:"Choose your aggregation function then the column to run this function on"},N.a.createElement(j.Select,{width:20,options:r,value:t.selectedAggregateType,defaultValue:t.selectedAggregateType,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return a("selectedAggregateType",{label:e,value:e})},onChange:function(e){return a("selectedAggregateType",e)},maxMenuHeight:200})),N.a.createElement(j.InlineField,null,N.a.createElement(j.Select,{options:c,value:t.aggregateColumn,defaultValue:t.aggregateColumn,width:20,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return a("aggregateColumn",e)},onCreateOption:function(e){var n=[];void 0!==t.aggregateColumn?(n=s([],u(t.aggregateColumn),!1))[n.length]={label:e,value:e}:n=[{label:e,value:e}],a("aggregateColumn",n)},maxMenuHeight:200}))))},X=function(e){var t=e.query,a=e.updateQuery,n=e.datasource,r=e.sysparamTypeOptions,l=e.loadChoices,c=u(Object(L.useState)([{label:"Loading ...",value:""}]),2),p=c[0],d=c[1];Object(L.useEffect)((function(){var e=[],a=!1;return function(){var r;i(this,void 0,void 0,(function(){return o(this,(function(l){switch(l.label){case 0:return[4,n.snowConnection.getTableColumnOptions(null===(r=t.tableName)||void 0===r?void 0:r.value)];case 1:return e=l.sent(),a||e.length>0&&d(e),[2]}}))}))}(),function(){a=!0}}),[n.snowConnection,t.tableName]);for(var m=s([],u(t.basic_sysparam),!1),v=function(e,t,n){var r=m;r[e][t]=n,a("basic_sysparam",r)},f=[{label:"AND",value:"^"},{label:"OR",value:"^OR"}],h=[],g=-1!==m.constructor.toString().indexOf("Array")?t.basic_sysparam.length:0,y=function(e){h.push(N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,0!==e&&N.a.createElement(j.InlineField,null,N.a.createElement(j.RadioButtonGroup,{options:f,value:void 0!==m[e][4]?m[e][4].value:null,onChange:function(t){return v(e,4,{label:t,value:t})}})),N.a.createElement(j.InlineField,{label:0===e?"Sysparam Query":void 0,labelWidth:0===e?20:void 0},N.a.createElement(j.Select,{className:"min-width-10",options:p,value:void 0!==m[e][1]?m[e][1]:null,defaultValue:void 0!==m[e][1]?m[e][1]:null,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(t){return v(e,1,t)},onCreateOption:function(t){return v(e,1,{label:t,value:t})},maxMenuHeight:200})),N.a.createElement(j.InlineField,null,N.a.createElement(j.Select,{width:20,options:r,value:void 0!==m[e][2]?m[e][2]:null,defaultValue:void 0!==m[e][2]?m[e][2]:null,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(t){return v(e,2,t)},onCreateOption:function(t){return v(e,2,{label:t,value:t})},maxMenuHeight:200})),N.a.createElement(j.InlineField,null,N.a.createElement(j.AsyncSelect,{className:"min-width-10",loadOptions:function(t){return l(e,t)},value:void 0!==m[e][3]?m[e][3]:null,defaultValue:void 0!==m[e][3]?m[e][3]:null,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(t){return v(e,3,t)},onCreateOption:function(t){return v(e,3,{label:t,value:t})},maxMenuHeight:200})),e>0&&N.a.createElement(j.InlineField,null,N.a.createElement(j.ToolbarButton,{icon:"trash-alt",variant:"destructive",iconOnly:!0,onClick:function(){return t=e,(n=m).splice(t,1),void a("basic_sysparam",n);var t,n}}))),e===g-1&&N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,null,N.a.createElement(j.ToolbarButton,{icon:"plus",variant:"primary",onClick:function(){return(e=m).push({1:null,2:null,3:null,4:{label:"AND",value:"^"}}),void a("basic_sysparam",e);var e}})))))},b=0;b<g;b++)y(b);return N.a.createElement(N.a.Fragment,null,h)},Z=function(e){var t=e.query,a=e.updateQuery,n=e.datasource,r=u(Object(L.useState)([{label:"Loading ...",value:""}]),2),l=r[0],s=r[1];return Object(L.useEffect)((function(){var e=[],a=!1;return function(){var r;i(this,void 0,void 0,(function(){return o(this,(function(l){switch(l.label){case 0:return[4,n.snowConnection.getTableColumnOptions(null===(r=t.tableName)||void 0===r?void 0:r.value)];case 1:return e=l.sent(),a||e.length>0&&(t.sortBy&&t.sortBy.length>0&&(e=e.concat(t.sortBy)),s(e)),[2]}}))}))}(),function(){a=!0}}),[n.snowConnection,t.tableName,t.sortBy]),N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Sort By",labelWidth:20},N.a.createElement(j.Select,{width:20,options:l,value:t.sortBy,defaultValue:t.sortBy,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return a("sortBy",e)},onCreateOption:function(e){return a("sortBy",{label:e,value:e})},maxMenuHeight:200,menuPlacement:"top"})),N.a.createElement(j.InlineField,null,N.a.createElement(j.RadioButtonGroup,{value:t.sortDirection,options:[{label:"ASC",value:"ASC",icon:"arrow-up"},{label:"DESC",value:"DESC",icon:"arrow-down"}],onChange:function(e){return a("sortDirection",e)}}))))},ee=function(e){var t=e.updateQuery,a=e.defaultValue;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Limit",labelWidth:20,tooltip:"Limit the number of results. Expects a number between 1 - 9999"},N.a.createElement(j.Input,{name:"limit",type:"number",max:9999,min:1,width:20,defaultValue:a,onBlur:function(e){return t("rowLimit",e.target.value)}}))))},te=function(e){var t=e.updateQuery,a=e.defaultValue;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Elastic Search Query",labelWidth:20},N.a.createElement(j.Input,{name:"elasticSearch",width:20,defaultValue:a,onBlur:function(e){return t("elasticSearch",e.target.value)}}))))},ae=function(e){var t=e.updateQuery,a=e.trendByOptions,n=e.query,r=e.datasource,l=u(Object(L.useState)([{label:"Loading ...",value:""}]),2),s=l[0],c=l[1];return Object(L.useEffect)((function(){var e=[],t=!1;return function(){var a;i(this,void 0,void 0,(function(){return o(this,(function(l){switch(l.label){case 0:return[4,r.snowConnection.getTableColumnOptions(null===(a=n.tableName)||void 0===a?void 0:a.value)];case 1:return e=l.sent(),t||e.length>0&&c(e),[2]}}))}))}(),function(){t=!0}}),[r.snowConnection,n.tableName]),N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Trend",labelWidth:20},N.a.createElement(j.Select,{className:"min-width-10 max-width-30",options:s,value:n.selectedTrendColumn,defaultValue:n.selectedTrendColumn,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return t("selectedTrendColumn",e)},onCreateOption:function(e){return t("selectedTrendColumn",{label:e,value:e})},maxMenuHeight:200})),N.a.createElement(j.InlineField,null,N.a.createElement(j.Select,{className:"min-width-10 max-width-30",options:a,value:n.selectedTrendBy,defaultValue:n.selectedTrendBy,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return t("selectedTrendBy",e)},onCreateOption:function(e){return t("selectedTrendBy",{label:e,value:e})},maxMenuHeight:200})),N.a.createElement(j.InlineField,null,N.a.createElement(j.Input,{name:"period",type:"number",max:300,min:1,width:20,defaultValue:n.trendPeriod,onBlur:function(e){return t("trendPeriod",e.target.value)}}))))},ne=function(e){var t=e.value,a=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Show Uptime %",labelWidth:20},N.a.createElement(j.RadioButtonGroup,{options:[{label:"False",value:!1},{label:"True",value:!0}],value:t||!1,onChange:function(e){return a("showPercent",e)}}))))},re=function(e){var t=e.defaultValue,a=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Page",labelWidth:20,tooltip:"Page number used for pagination. Starts at page 0"},N.a.createElement(j.Input,{name:"page",type:"number",max:9999,min:0,width:20,defaultValue:t,onBlur:function(e){return a("page",e.target.valueAsNumber)}}))))},le=function(e){var t=e.value,a=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Query Alert Count",labelWidth:20,tooltip:"Extra query per row to get the number of alerts on a ci. Adds extra processing, use wisely!"},N.a.createElement(j.RadioButtonGroup,{value:t.value,options:[{label:"No",value:"false"},{label:"Yes",value:"true"}],onChange:function(e){return a("getAlertCount",{label:e,value:e})}}))))},ie=function(e){var t=e.value,a=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,null,N.a.createElement(j.RefreshPicker,{value:t,text:"Cache Override",intervals:["5s","30s","60s","2m","5m","15m","30m"],onIntervalChanged:function(e){return a("cacheOverride",e)}}))))},oe=function(e){var t=e.value,a=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Compress Logs",labelWidth:20},N.a.createElement(j.InlineSwitch,{value:t,onChange:function(e){return a("compressLogs",e.target.checked)}}))))},ue=function(e){var t=e.query,a=e.updateQuery,n=e.datasource,r=u(Object(L.useState)([{label:"Loading ...",value:""}]),2),l=r[0],s=r[1];return Object(L.useEffect)((function(){var e=[],a=!1;return function(){var r;i(this,void 0,void 0,(function(){return o(this,(function(l){switch(l.label){case 0:return[4,n.snowConnection.getTableColumnOptions(null===(r=t.tableName)||void 0===r?void 0:r.value)];case 1:return e=l.sent(),a||e.length>0&&(t.grafanaTimerangeColumn&&t.grafanaTimerangeColumn.length>0&&(e=e.concat(t.grafanaTimerangeColumn)),s(e)),[2]}}))}))}(),function(){a=!0}}),[n.snowConnection,t.tableName,t.grafanaTimerangeColumn]),N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Grafana Timerange",labelWidth:20,tooltip:"If selected, only results that fit inbetween your Grafana Timerange will be returned"},N.a.createElement(j.InlineSwitch,{value:t.grafanaTimerange,onChange:function(e){return a("grafanaTimerange",e.target.checked)}})),t.grafanaTimerange&&N.a.createElement(j.InlineField,null,N.a.createElement(j.Select,{options:l,value:t.grafanaTimerangeColumn,defaultValue:t.grafanaTimerangeColumn,width:20,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return a("grafanaTimerangeColumn",e)},onCreateOption:function(e){return a("grafanaTimerangeColumn",{label:e,value:e})},maxMenuHeight:200}))))},se=function(e){var t=e.query,a=e.updateQuery,n=e.datasource,r=e.replaceMultipleVariables,l=u(Object(L.useState)([{label:"Loading...",value:""}]),2),c=l[0],p=l[1],d=u(Object(L.useState)([{label:"Loading...",value:""}]),2),v=d[0],f=d[1];Object(L.useEffect)((function(){var e=[],l=[],u=[];!function(){i(this,void 0,void 0,(function(){var i,s,c,d,v,h;return o(this,(function(o){switch(o.label){case 0:return i=t.selectedAlertStateList,s=t.sysparam_query,c=t.rowLimit,s=r(s),[4,n.snowConnection.getAlertTags(i,s,c)];case 1:for(u=o.sent(),d=function(a){e.push({label:u[a].key,value:u[a].key}),void 0!==t.tagKeys&&void 0!==t.tagKeys[0]&&"$"!==t.tagKeys[0].value.charAt(0)&&t.tagKeys.map((function(e){u[a].key===e.value&&l.push({label:u[a].value,value:u[a].value})}))},v=0;v<u.length;v++)d(v);return e=e.filter((function(e,t,a){return t===a.findIndex((function(t){return t.value===e.value}))})),l=l.filter((function(e,t,a){return t===a.findIndex((function(t){return t.value===e.value}))})),t.tagValues&&t.tagValues[0]&&"$"!==t.tagValues[0].value.charAt(0)&&(h=t.tagValues,t.tagValues.map((function(e,t){if(!e.custom){var a=!1;l.map((function(t){e.value!==t.value||e.custom||(a=!0)})),a||h.splice(t,1)}})),Object(m.isEqual)(h,t.tagValues)||a("tagValues",h)),p(e),f(l),[2]}}))}))}()}),[n.snowConnection,t,a,r]);var h=c;void 0!==t.tagKeys&&(h=s(s([],u(c),!1),[t.tagKeys],!1),h=[].concat.apply([],h));var g=v;return void 0!==t.tagValues&&(g=s(s([],u(v),!1),[t.tagValues],!1),g=[].concat.apply([],g)),N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Tag Keys",labelWidth:20,tooltip:"Filter by tags located in additional info"},N.a.createElement(j.Select,{className:"min-width-10 max-width-20",options:h,value:t.tagKeys,defaultValue:t.tagKeys,isSearchable:!0,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return a("tagKeys",e)},onCreateOption:function(e){var n={label:e,value:e},r=[];t.tagKeys?(r=s([],u(t.tagKeys),!1)).push(n):r=[n],a("tagKeys",r)},maxMenuHeight:200})),N.a.createElement(j.InlineField,{label:"Tag Values",labelWidth:20},N.a.createElement(j.Select,{className:"min-width-10 max-width-20",options:g,value:t.tagValues,defaultValue:t.tagValues,isSearchable:!0,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return a("tagValues",e)},onCreateOption:function(e){var n={label:e,value:e,custom:!0},r=[];t.tagValues?(r=s([],u(t.tagValues),!1)).push(n):r=[n],a("tagValues",r)},maxMenuHeight:200}))))},ce=function(e){var t,a=e.query,n=e.onChange,r=e.datasource,i=Object(m.defaults)(a,f),o=r.snowConnection.getMetricAnomalyOptions(),u=r.snowConnection.getAlertTypeOptions(),s=r.snowConnection.getAlertStateOptions(),c=r.snowConnection.getChangeTypeOptions(),p=r.snowConnection.getSysparamTypeOptions(),v=r.snowConnection.getTrendByOptions(),h=function(e){return new Promise((function(t){setTimeout((function(){t(r.snowConnection.loadServiceOptions(e))}),500)}))},g=function(e){return new Promise((function(t){setTimeout((function(){var a;t(r.snowConnection.loadCIOptions(null===(a=i.selectedServiceList)||void 0===a?void 0:a.value,e))}),500)}))},y=function(e,t){return new Promise((function(a){setTimeout((function(){var n,l;a(r.snowConnection.loadColumnChoices(null===(n=i.tableName)||void 0===n?void 0:n.value,null===(l=i.basic_sysparam[e][1])||void 0===l?void 0:l.value,t))}),500)}))},b=function(e){return new Promise((function(t){setTimeout((function(){t(r.snowConnection.loadTableOptions(e))}),500)}))},C=function(e,t){var a;n(l(l({},i),((a={})[e]=t,a)))},w=function(e){for(var t=i,a=0;a<e.length;a++)t[e[a].key]=e[a].value;n(t)},E={Table:{title:"Table",description:"Choose your own table to gather data from",content:N.a.createElement(N.a.Fragment,null,N.a.createElement($,{updateQuery:C,loadTableOptions:b,value:i.tableName}),N.a.createElement(z,{query:i,updateQuery:C,datasource:r}),N.a.createElement(X,{query:i,updateQuery:C,datasource:r,sysparamTypeOptions:p,loadChoices:y}),N.a.createElement(Z,{query:i,updateQuery:C,datasource:r}),N.a.createElement(ee,{defaultValue:i.rowLimit,updateQuery:C}),N.a.createElement(re,{defaultValue:i.page,updateQuery:C}),N.a.createElement(le,{value:i.getAlertCount,updateQuery:C}),N.a.createElement(ue,{query:i,updateQuery:C,datasource:r}))},Aggregate:{title:"Aggregate",description:"Group by and apply aggregate functions to table data",content:N.a.createElement(N.a.Fragment,null,N.a.createElement($,{updateQuery:C,loadTableOptions:b,value:i.tableName}),N.a.createElement(Y,{query:i,updateQuery:C,datasource:r}),N.a.createElement(J,{query:i,updateQuery:C,datasource:r}),N.a.createElement(D,{updateQuery:C,defaultValue:i.sysparam_query}),N.a.createElement(ee,{defaultValue:i.rowLimit,updateQuery:C}),N.a.createElement(ue,{query:i,updateQuery:C,datasource:r}))},Alerts:{title:"Alerts",description:"Get Alerts",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(q,{loadOptions:h,value:i.selectedServiceList,updateQuery:C}),N.a.createElement(P,{loadOptions:g,value:i.selectedSourceList,updateQuery:C}),N.a.createElement(B,{options:u,value:i.selectedAlertTypeList,updateQuery:C}),N.a.createElement(k,{options:s,value:i.selectedAlertStateList,updateQuery:C}),N.a.createElement(D,{updateQuery:C,defaultValue:i.sysparam_query}),N.a.createElement(se,{query:i,updateQuery:C,datasource:r,replaceMultipleVariables:function(e){if(!e)return"";for(var t,a=e.indexOf("$"),n=function(){var e={};return Object.values(Object(d.getTemplateSrv)().getVariables()).forEach((function(t){if("adhoc"!==t.type&&"interval"!==t.type){var a=t,n=a.current.value;if("$__all"===n||Object(m.isEqual)(n,["$__all"]))if(null===a.allValue||""===a.allValue){for(var r="",l=1;l<a.options.length;l++)r+=a.options[l].value+",";","===r.charAt(r.length-1)&&(r=r.substring(0,r.length-1)),n=r}else n=a.allValue;e[a.id]={text:a.current.text,value:n}}})),e}();-1!==a;){var r=-1===e.indexOf("^",a)?e.length:e.indexOf("^",a),l=e.substring(a,r),i=l,o=("$"===(t=l).charAt(0)&&"{"===(t=t.substring(1)).charAt(0)&&"}"===t.charAt(t.length-1)&&(t=t.substring(1,t.length-1)),t);void 0!==n[o]&&(i=n[o].value),a=(e=e.replace(l,i)).indexOf("$")}return e}}),N.a.createElement(Z,{query:i,updateQuery:C,datasource:r}),N.a.createElement(ee,{defaultValue:i.rowLimit,updateQuery:C}),N.a.createElement(re,{defaultValue:i.page,updateQuery:C}),N.a.createElement(ue,{query:i,updateQuery:C,datasource:r}))},Anomaly:{title:"Anomaly",description:"Parse values out of Alert Anomalies table",content:N.a.createElement(N.a.Fragment,null,N.a.createElement($,{updateQuery:C,loadTableOptions:b,value:i.tableName}),N.a.createElement(z,{query:i,updateQuery:C,datasource:r}),N.a.createElement(X,{query:i,updateQuery:C,datasource:r,sysparamTypeOptions:p,loadChoices:y}),N.a.createElement(Z,{query:i,updateQuery:C,datasource:r}),N.a.createElement(ee,{defaultValue:i.rowLimit,updateQuery:C}),N.a.createElement(re,{defaultValue:i.page,updateQuery:C}))},Changes:{title:"Changes",description:"Get Changes",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(q,{loadOptions:h,value:i.selectedServiceList,updateQuery:C}),N.a.createElement(P,{loadOptions:g,value:i.selectedSourceList,updateQuery:C}),N.a.createElement(W,{options:c,value:i.selectedChangeTypeList,updateQuery:C}),N.a.createElement(D,{updateQuery:C,defaultValue:i.sysparam_query}),N.a.createElement(Z,{query:i,updateQuery:C,datasource:r}),N.a.createElement(ee,{defaultValue:i.rowLimit,updateQuery:C}),N.a.createElement(re,{defaultValue:i.page,updateQuery:C}),N.a.createElement(ue,{query:i,updateQuery:C,datasource:r}))},Geohash_Map:{title:"GeoHash Map",description:"Get map data from AWS or Azure",content:N.a.createElement(N.a.Fragment,null,N.a.createElement($,{updateQuery:C,loadTableOptions:b,value:i.tableName}),N.a.createElement(Y,{query:i,updateQuery:C,datasource:r}),N.a.createElement(D,{updateQuery:C,defaultValue:i.sysparam_query}))},Live_Agent_Data:{title:"Live Agent Data",description:"Get Live Data from your ACC Agents",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(U,{updateQuery:C,defaultValue:i.live_osquery}))},Log_Data:{title:"Log Data",description:"Get log data",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(oe,{value:i.compressLogs,updateQuery:C}),N.a.createElement(X,{query:i,updateQuery:C,datasource:r,sysparamTypeOptions:p,loadChoices:y}),N.a.createElement(te,{updateQuery:C,defaultValue:i.elasticSearch}),N.a.createElement(Z,{query:i,updateQuery:C,datasource:r}),N.a.createElement(ee,{defaultValue:i.rowLimit,updateQuery:C}),N.a.createElement(re,{defaultValue:i.page,updateQuery:C}))},Metrics:{title:"Metrics",description:"Get Timeseries metrics",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(q,{loadOptions:h,value:i.selectedServiceList,updateQuery:C}),N.a.createElement(P,{loadOptions:g,value:i.selectedSourceList,updateQuery:C}),N.a.createElement(Q,{loadOptions:function(e){return new Promise((function(t){setTimeout((function(){t(r.snowConnection.loadResourceOptions(i.selectedSourceList,e))}),500)}))},value:i.selectedMetricTypeList,updateQuery:C}),N.a.createElement(R,{loadOptions:function(e){return new Promise((function(t){setTimeout((function(){t(r.snowConnection.loadMetricOptions(i.selectedSourceList,e))}),500)}))},value:i.selectedMetricNameList,updateQuery:C}),N.a.createElement(M,{options:o,value:i.selectedMetricAnomalyList,updateQuery:C}),N.a.createElement(D,{updateQuery:C,defaultValue:i.sysparam_query}))},Outage_Status:{title:"Outage Status",description:"Gathers business service status over the last 90 days",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(q,{loadOptions:h,value:i.selectedServiceList,updateQuery:C}),N.a.createElement(ne,{value:i.showPercent,updateQuery:C}),N.a.createElement(D,{updateQuery:C,defaultValue:i.sysparam_query}),N.a.createElement(ee,{defaultValue:i.rowLimit,updateQuery:C}),N.a.createElement(re,{defaultValue:i.page,updateQuery:C}))},Row_Count:{title:"Row Count",description:"Get row count from query",content:N.a.createElement(N.a.Fragment,null,N.a.createElement($,{updateQuery:C,loadTableOptions:b,value:i.tableName}),N.a.createElement(D,{updateQuery:C,defaultValue:i.sysparam_query}),N.a.createElement(ue,{query:i,updateQuery:C,datasource:r}))},Topology:{title:"Topology",description:"Get Topology",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(G,{loadOptions:h,value:i.selectedServiceList,updateQuery:C}),N.a.createElement(H,{updateQuery:C,defaultValue:i.topology_parent_depth}),N.a.createElement(K,{updateQuery:C,defaultValue:i.topology_child_depth}),N.a.createElement(D,{updateQuery:C,defaultValue:i.sysparam_query}))},Trend_Data:{title:"Trend Data",description:"Get timeseries data based on a time trend",content:N.a.createElement(N.a.Fragment,null,N.a.createElement($,{updateQuery:C,loadTableOptions:b,value:i.tableName}),N.a.createElement(X,{query:i,updateQuery:C,datasource:r,sysparamTypeOptions:p,loadChoices:y}),N.a.createElement(te,{updateQuery:C,defaultValue:i.elasticSearch}),N.a.createElement(Y,{query:i,updateQuery:C,datasource:r}),N.a.createElement(ae,{query:i,updateQuery:C,trendByOptions:v,datasource:r}))}};return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.HorizontalGroup,{justify:"space-between"},N.a.createElement(j.InlineFieldRow,{style:{paddingTop:"8px"}},N.a.createElement(j.InlineField,{label:"Query Category",labelWidth:20},N.a.createElement(j.Select,{className:"min-width-10 max-width-30",options:function(){var e=[];for(var t in E){var a=E[t];e.push({label:a.title,value:t,description:a.description})}return e}(),value:i.selectedQueryCategory,onChange:function(e){"Anomaly"===e.label?w([{key:"tableName",value:{label:"Alert Anomaly",value:"em_alert_anomaly",description:"em_alert_anomaly"}},{key:"selectedQueryCategory",value:e}]):C("selectedQueryCategory",e)},menuPlacement:"bottom",maxMenuHeight:220}))),N.a.createElement(ie,{value:i.cacheOverride,updateQuery:C})),E[null!==(t=i.selectedQueryCategory.value)&&void 0!==t?t:""].content)};a.d(t,"plugin",(function(){return pe}));var pe=new n.DataSourcePlugin(F).setConfigEditor((function(e){var t=e.options,a=e.onOptionsChange;""===t.url&&(t.url="https://<instance_name>.service-now.com/"),void 0===t.jsonData.apiPath&&(t.jsonData.apiPath="/api/snc/grafana_api"),void 0===t.jsonData.cacheTimeout&&(t.jsonData.cacheTimeout=60),void 0===t.jsonData.imageURL&&(t.jsonData.imageURL="https://yiij743y0gi4fteri1asp7p6-wpengine.netdna-ssl.com/wp-content/uploads/2019/03/RegoLink-integration-icons-01.png");var n=function(e,n){var r;a(l(l({},t),{jsonData:l(l({},t.jsonData),(r={},r[e]=n,r))}))};return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.Alert,{title:"Need more information?",severity:"info",elevated:!0},N.a.createElement(j.VerticalGroup,null,N.a.createElement("p",null,"Local documentation can be found in Configuration => Plugins on this plugin's page"),N.a.createElement("p",null,"Or"," ",N.a.createElement("a",{href:"https://github.com/optimizca/servicenow-grafana/blob/main/README.md"},"Click here to view the documentation on GitHub")))),N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{labelWidth:20,label:"Logo URL",tooltip:"To access this value in each dashboard, create a variable query using namespace: global_image."},N.a.createElement(j.Input,{defaultValue:void 0===t.jsonData.imageURL?"":t.jsonData.imageURL,onBlur:function(e){return n("imageURL",e.target.value)},width:60}))),N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{labelWidth:20,label:"API Path"},N.a.createElement(j.Input,{defaultValue:void 0===t.jsonData.apiPath?"":t.jsonData.apiPath,onBlur:function(e){return n("apiPath",e.target.value)},width:40}))),N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{labelWidth:20,label:"Cache Timeout",tooltip:"Number of seconds to cache a request for. This can be overridden in the query panel."},N.a.createElement(j.Select,{value:t.jsonData.cacheTimeout,options:[{label:"30m",value:1800},{label:"15m",value:900},{label:"5m",value:300},{label:"2m",value:120},{label:"60s",value:60},{label:"30s",value:30},{label:"5s",value:5}],allowCustomValue:!1,backspaceRemovesValue:!1,isClearable:!1,isSearchable:!0,isMulti:!1,onChange:function(e){return n("cacheTimeout",e.value)}}))),N.a.createElement(j.DataSourceHttpSettings,{defaultUrl:"https://<instance_name>.service-now.com/",dataSourceConfig:t,showAccessOptions:!0,sigV4AuthToggleEnabled:!1,showForwardOAuthIdentityOption:!1,onChange:function(e){var t="";-1!==e.url.indexOf("https://")?t=e.url.substring(8,e.url.indexOf(".service-now",8)):-1!==e.url.indexOf("http://")&&(t=e.url.substring(7,e.url.indexOf(".service-now",7))),e.jsonData.instanceName=t,a(e)}}))})).setQueryEditor((function(e){return N.a.createElement(ce,l({},e))})).setVariableQueryEditor((function(e){var t=e.onChange,a=e.query,n=u(Object(L.useState)(a),2),r=n[0],i=n[1],o=function(){t(r,r.rawQuery+" ("+r.namespace+")")},s=function(e,t){var a;i(l(l({},r),((a={})[e]=t,a)))};return N.a.createElement(N.a.Fragment,null,N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Namespace",labelWidth:20},N.a.createElement(j.Select,{options:[{label:"global_image",value:"global_image"},{label:"global_instance_name",value:"global_instance_name"},{label:"metric_names",value:"metric_names"},{label:"golden_metric_names",value:"golden_metric_names"},{label:"custom_kpis",value:"custom_kpis"},{label:"generic",value:"generic"},{label:"nested_cis",value:"nested_cis"},{label:"nested_classes",value:"nested_classes"},{label:"tagKeys",value:"tagKeys"},{label:"tagValues",value:"tagValues"}],value:r.namespace,onChange:function(e){return s("namespace",e.value)},allowCustomValue:!1,isClearable:!1,isSearchable:!0,onBlur:o,width:30}))),N.a.createElement(j.InlineFieldRow,null,N.a.createElement(j.InlineField,{label:"Query",labelWidth:20,grow:!0,tooltip:N.a.createElement("p",null,"Documentation for variables can be found"," ",N.a.createElement("a",{href:"https://github.com/optimizca/servicenow-grafana#variables",rel:"noopener noreferrer",target:"_blank"},"(Here)"))},N.a.createElement(j.Input,{name:"rawQuery",onChange:function(e){return s("rawQuery",e.target.value)},onBlur:o,value:r.rawQuery}))))}))}])}));
//# sourceMappingURL=module.js.map